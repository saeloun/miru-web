10 processes for 249 specs, ~ 24 specs per process
.....................................................
1st Try error in ./spec/lib/file_uploader_spec.rb:44:
To use ActiveJob matchers set `ActiveJob::Base.queue_adapter = :test`

RSpec::Retry: 2nd try ./spec/lib/file_uploader_spec.rb:44

2nd Try error in ./spec/lib/file_uploader_spec.rb:44:
To use ActiveJob matchers set `ActiveJob::Base.queue_adapter = :test`
RSpec::Retry: 3rd try ./spec/lib/file_uploader_spec.rb:44
.F...
1st Try error in ./spec/mailers/send_weekly_reminder_to_user_mailer_spec.rb:12:
To use ActiveJob matchers set `ActiveJob::Base.queue_adapter = :test`

RSpec::Retry: 2nd try ./spec/mailers/send_weekly_reminder_to_user_mailer_spec.rb:12
..
2nd Try error in ./spec/mailers/send_weekly_reminder_to_user_mailer_spec.rb:12:
To use ActiveJob matchers set `ActiveJob::Base.queue_adapter = :test`
RSpec::Retry: 3rd try ./spec/mailers/send_weekly_reminder_to_user_mailer_spec.rb:12
.F...................................................................*........
An error occurred in a `before(:suite)` hook.
Failure/Error: DatabaseCleaner.clean_with :truncation, except: %w(ar_internal_metadata)

ActiveRecord::Deadlocked:
  PG::TRDeadlockDetected: ERROR:  deadlock detected
  DETAIL:  Process 96678 waits for AccessExclusiveLock on relation 8723309 of database 8720960; blocked by process 93979.
  Process 93979 waits for AccessShareLock on relation 8914767 of database 8720960; blocked by process 96678.
  HINT:  See server log for query details.
# ./spec/support/database_cleaner.rb:8:in 'block (2 levels) in <top (required)>'
# ------------------
# --- Caused by: ---
# PG::TRDeadlockDetected:
#   ERROR:  deadlock detected
#   DETAIL:  Process 96678 waits for AccessExclusiveLock on relation 8723309 of database 8720960; blocked by process 93979.
#   Process 93979 waits for AccessShareLock on relation 8914767 of database 8720960; blocked by process 96678.
#   HINT:  See server log for query details.
#   ./spec/support/database_cleaner.rb:8:in 'block (2 levels) in <top (required)>'


Finished in 1.02 seconds (files took 14.04 seconds to load)
0 examples, 0 failures, 1 error occurred outside of examples

....
1st Try error in ./spec/models/concerns/pg_searchable_spec.rb:124:
expected #<ActiveRecord::Relation [#<TimesheetEntry id: 1, user_id: 14, project_id: 6, duration: 480.0, note: ...85000 +0000", updated_at: "2025-08-10 14:54:41.983685000 +0000", discarded_at: nil, locked: false>]> not to include #<TimesheetEntry id: 2, user_id: 14, project_id: 6, duration: 480.0, note: "Bug fixing", work_date: "...3685000 +0000", updated_at: "2025-08-10 14:54:41.983685000 +0000", discarded_at: nil, locked: false>
Diff:
@@ -1 +1,24 @@
-[#<TimesheetEntry id: 2, user_id: 14, project_id: 6, duration: 480.0, note: "Bug fixing", work_date: "2025-08-10", bill_status: "non_billable", created_at: "2025-08-10 14:54:41.983685000 +0000", updated_at: "2025-08-10 14:54:41.983685000 +0000", discarded_at: nil, locked: false>]
+[#<TimesheetEntry:0x0000000304c762d8
+  id: 1,
+  user_id: 14,
+  project_id: 6,
+  duration: 480.0,
+  note: "Working on feature",
+  work_date: "2025-08-10",
+  bill_status: "non_billable",
+  created_at: "2025-08-10 14:54:41.980255000 +0000",
+  updated_at: "2025-08-10 14:54:41.980255000 +0000",
+  discarded_at: nil,
+  locked: false>,
+ #<TimesheetEntry:0x0000000304c76058
+  id: 2,
+  user_id: 14,
+  project_id: 6,
+  duration: 480.0,
+  note: "Bug fixing",
+  work_date: "2025-08-10",
+  bill_status: "non_billable",
+  created_at: "2025-08-10 14:54:41.983685000 +0000",
+  updated_at: "2025-08-10 14:54:41.983685000 +0000",
+  discarded_at: nil,
+  locked: false>]


RSpec::Retry: 2nd try ./spec/models/concerns/pg_searchable_spec.rb:124
...
2nd Try error in ./spec/models/concerns/pg_searchable_spec.rb:124:
expected #<ActiveRecord::Relation [#<TimesheetEntry id: 3, user_id: 15, project_id: 7, duration: 480.0, note: ...05000 +0000", updated_at: "2025-08-10 14:54:42.063805000 +0000", discarded_at: nil, locked: false>]> not to include #<TimesheetEntry id: 4, user_id: 15, project_id: 7, duration: 480.0, note: "Bug fixing", work_date: "...3805000 +0000", updated_at: "2025-08-10 14:54:42.063805000 +0000", discarded_at: nil, locked: false>
Diff:
@@ -1 +1,24 @@
-[#<TimesheetEntry id: 4, user_id: 15, project_id: 7, duration: 480.0, note: "Bug fixing", work_date: "2025-08-10", bill_status: "non_billable", created_at: "2025-08-10 14:54:42.063805000 +0000", updated_at: "2025-08-10 14:54:42.063805000 +0000", discarded_at: nil, locked: false>]
+[#<TimesheetEntry:0x000000030469e608
+  id: 3,
+  user_id: 15,
+  project_id: 7,
+  duration: 480.0,
+  note: "Working on feature",
+  work_date: "2025-08-10",
+  bill_status: "non_billable",
+  created_at: "2025-08-10 14:54:42.061239000 +0000",
+  updated_at: "2025-08-10 14:54:42.061239000 +0000",
+  discarded_at: nil,
+  locked: false>,
+ #<TimesheetEntry:0x000000030469e4c8
+  id: 4,
+  user_id: 15,
+  project_id: 7,
+  duration: 480.0,
+  note: "Bug fixing",
+  work_date: "2025-08-10",
+  bill_status: "non_billable",
+  created_at: "2025-08-10 14:54:42.063805000 +0000",
+  updated_at: "2025-08-10 14:54:42.063805000 +0000",
+  discarded_at: nil,
+  locked: false>]

RSpec::Retry: 3rd try ./spec/models/concerns/pg_searchable_spec.rb:124
.....F...../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
...
1st Try error in ./spec/models/concerns/pg_searchable_spec.rb:149:
expected #<ActiveRecord::Relation [#<Expense id: 1, date: "2025-08-10", amount: 0.1e3, expense_type: "personal...ated_at: "2025-08-10 14:54:42.216253000 +0000", updated_at: "2025-08-10 14:54:42.216253000 +0000">]> not to include #<Expense id: 1, date: "2025-08-10", amount: 0.1e3, expense_type: "personal", description: "Office su...reated_at: "2025-08-10 14:54:42.205541000 +0000", updated_at: "2025-08-10 14:54:42.205541000 +0000">
Diff:
@@ -1 +1,22 @@
-[#<Expense id: 1, date: "2025-08-10", amount: 0.1e3, expense_type: "personal", description: "Office supplies", company_id: 28, expense_category_id: 1, vendor_id: nil, created_at: "2025-08-10 14:54:42.205541000 +0000", updated_at: "2025-08-10 14:54:42.205541000 +0000">]
+[#<Expense:0x0000000169451540
+  id: 1,
+  date: "2025-08-10",
+  amount: 0.1e3,
+  expense_type: "personal",
+  description: "Office supplies",
+  company_id: 28,
+  expense_category_id: 1,
+  vendor_id: nil,
+  created_at: "2025-08-10 14:54:42.205541000 +0000",
+  updated_at: "2025-08-10 14:54:42.205541000 +0000">,
+ #<Expense:0x0000000169450b40
+  id: 2,
+  date: "2025-07-05",
+  amount: 0.5e3,
+  expense_type: "personal",
+  description: "Software license",
+  company_id: 28,
+  expense_category_id: 1,
+  vendor_id: 1,
+  created_at: "2025-08-10 14:54:42.216253000 +0000",
+  updated_at: "2025-08-10 14:54:42.216253000 +0000">]


RSpec::Retry: 2nd try ./spec/models/concerns/pg_searchable_spec.rb:149
...
2nd Try error in ./spec/models/concerns/pg_searchable_spec.rb:149:
expected #<ActiveRecord::Relation [#<Expense id: 3, date: "2025-07-11", amount: 0.1e3, expense_type: "business...ated_at: "2025-08-10 14:54:42.243845000 +0000", updated_at: "2025-08-10 14:54:42.243845000 +0000">]> not to include #<Expense id: 3, date: "2025-07-11", amount: 0.1e3, expense_type: "business", description: "Office su...reated_at: "2025-08-10 14:54:42.238464000 +0000", updated_at: "2025-08-10 14:54:42.238464000 +0000">
Diff:
@@ -1 +1,22 @@
-[#<Expense id: 3, date: "2025-07-11", amount: 0.1e3, expense_type: "business", description: "Office supplies", company_id: 29, expense_category_id: 2, vendor_id: nil, created_at: "2025-08-10 14:54:42.238464000 +0000", updated_at: "2025-08-10 14:54:42.238464000 +0000">]
+[#<Expense:0x00000001690ba8c8
+  id: 3,
+  date: "2025-07-11",
+  amount: 0.1e3,
+  expense_type: "business",
+  description: "Office supplies",
+  company_id: 29,
+  expense_category_id: 2,
+  vendor_id: nil,
+  created_at: "2025-08-10 14:54:42.238464000 +0000",
+  updated_at: "2025-08-10 14:54:42.238464000 +0000">,
+ #<Expense:0x00000001690ba788
+  id: 4,
+  date: "2025-07-20",
+  amount: 0.5e3,
+  expense_type: "business",
+  description: "Software license",
+  company_id: 29,
+  expense_category_id: 2,
+  vendor_id: 2,
+  created_at: "2025-08-10 14:54:42.243845000 +0000",
+  updated_at: "2025-08-10 14:54:42.243845000 +0000">]

RSpec::Retry: 3rd try ./spec/models/concerns/pg_searchable_spec.rb:149
...F.....***..................
1st Try error in ./spec/models/concerns/pg_searchable_spec.rb:170:
expected #<ActiveRecord::Relation [#<Invitation id: 1, company_id: 32, sender_id: 18, recipient_email: [FILTER...0000", updated_at: "2025-08-10 14:54:42.401783000 +0000", client_id: nil, virtual_verified: false>]> not to include #<Invitation id: 2, company_id: 32, sender_id: 18, recipient_email: [FILTERED], token: [FILTERED], ac... +0000", updated_at: "2025-08-10 14:54:42.401783000 +0000", client_id: nil, virtual_verified: false>
Diff:
@@ -1 +1,30 @@
-[#<Invitation id: 2, company_id: 32, sender_id: 18, recipient_email: [FILTERED], token: [FILTERED], accepted_at: nil, expired_at: "2025-08-24 14:54:42.397977000 +0000", first_name: "Bob", last_name: "Green", role: "employee", created_at: "2025-08-10 14:54:42.401783000 +0000", updated_at: "2025-08-10 14:54:42.401783000 +0000", client_id: nil, virtual_verified: false>]
+[#<Invitation:0x0000000168eb1400
+  id: 1,
+  company_id: 32,
+  sender_id: 18,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.369795000 +0000",
+  first_name: "Alice",
+  last_name: "Brown",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.379167000 +0000",
+  updated_at: "2025-08-10 14:54:42.379167000 +0000",
+  client_id: nil,
+  virtual_verified: false>,
+ #<Invitation:0x0000000168eb12c0
+  id: 2,
+  company_id: 32,
+  sender_id: 18,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.397977000 +0000",
+  first_name: "Bob",
+  last_name: "Green",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.401783000 +0000",
+  updated_at: "2025-08-10 14:54:42.401783000 +0000",
+  client_id: nil,
+  virtual_verified: false>]


RSpec::Retry: 2nd try ./spec/models/concerns/pg_searchable_spec.rb:170
.......
2nd Try error in ./spec/models/concerns/pg_searchable_spec.rb:170:
expected #<ActiveRecord::Relation [#<Invitation id: 3, company_id: 34, sender_id: 19, recipient_email: [FILTER...0000", updated_at: "2025-08-10 14:54:42.472627000 +0000", client_id: nil, virtual_verified: false>]> not to include #<Invitation id: 4, company_id: 34, sender_id: 19, recipient_email: [FILTERED], token: [FILTERED], ac... +0000", updated_at: "2025-08-10 14:54:42.472627000 +0000", client_id: nil, virtual_verified: false>
Diff:
@@ -1 +1,30 @@
-[#<Invitation id: 4, company_id: 34, sender_id: 19, recipient_email: [FILTERED], token: [FILTERED], accepted_at: nil, expired_at: "2025-08-24 14:54:42.469467000 +0000", first_name: "Bob", last_name: "Green", role: "employee", created_at: "2025-08-10 14:54:42.472627000 +0000", updated_at: "2025-08-10 14:54:42.472627000 +0000", client_id: nil, virtual_verified: false>]
+[#<Invitation:0x0000000168776b90
+  id: 3,
+  company_id: 34,
+  sender_id: 19,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.453205000 +0000",
+  first_name: "Alice",
+  last_name: "Brown",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.456573000 +0000",
+  updated_at: "2025-08-10 14:54:42.456573000 +0000",
+  client_id: nil,
+  virtual_verified: false>,
+ #<Invitation:0x0000000168776910
+  id: 4,
+  company_id: 34,
+  sender_id: 19,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.469467000 +0000",
+  first_name: "Bob",
+  last_name: "Green",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.472627000 +0000",
+  updated_at: "2025-08-10 14:54:42.472627000 +0000",
+  client_id: nil,
+  virtual_verified: false>]

RSpec::Retry: 3rd try ./spec/models/concerns/pg_searchable_spec.rb:170
....../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
...F../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
........
1st Try error in ./spec/models/concerns/pg_searchable_spec.rb:177:
expected #<ActiveRecord::Relation [#<Invitation id: 7, company_id: 38, sender_id: 21, recipient_email: [FILTER...0000", updated_at: "2025-08-10 14:54:42.611077000 +0000", client_id: nil, virtual_verified: false>]> not to include #<Invitation id: 7, company_id: 38, sender_id: 21, recipient_email: [FILTERED], token: [FILTERED], ac... +0000", updated_at: "2025-08-10 14:54:42.596696000 +0000", client_id: nil, virtual_verified: false>
Diff:
@@ -1 +1,30 @@
-[#<Invitation id: 7, company_id: 38, sender_id: 21, recipient_email: [FILTERED], token: [FILTERED], accepted_at: nil, expired_at: "2025-08-24 14:54:42.593134000 +0000", first_name: "Alice", last_name: "Brown", role: "employee", created_at: "2025-08-10 14:54:42.596696000 +0000", updated_at: "2025-08-10 14:54:42.596696000 +0000", client_id: nil, virtual_verified: false>]
+[#<Invitation:0x0000000305055b60
+  id: 7,
+  company_id: 38,
+  sender_id: 21,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.593134000 +0000",
+  first_name: "Alice",
+  last_name: "Brown",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.596696000 +0000",
+  updated_at: "2025-08-10 14:54:42.596696000 +0000",
+  client_id: nil,
+  virtual_verified: false>,
+ #<Invitation:0x0000000305055a20
+  id: 8,
+  company_id: 38,
+  sender_id: 21,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.608395000 +0000",
+  first_name: "Bob",
+  last_name: "Green",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.611077000 +0000",
+  updated_at: "2025-08-10 14:54:42.611077000 +0000",
+  client_id: nil,
+  virtual_verified: false>]


RSpec::Retry: 2nd try ./spec/models/concerns/pg_searchable_spec.rb:177
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
.
2nd Try error in ./spec/models/concerns/pg_searchable_spec.rb:177:
expected #<ActiveRecord::Relation [#<Invitation id: 9, company_id: 40, sender_id: 22, recipient_email: [FILTER...0000", updated_at: "2025-08-10 14:54:42.714477000 +0000", client_id: nil, virtual_verified: false>]> not to include #<Invitation id: 9, company_id: 40, sender_id: 22, recipient_email: [FILTERED], token: [FILTERED], ac... +0000", updated_at: "2025-08-10 14:54:42.647989000 +0000", client_id: nil, virtual_verified: false>
Diff:
@@ -1 +1,30 @@
-[#<Invitation id: 9, company_id: 40, sender_id: 22, recipient_email: [FILTERED], token: [FILTERED], accepted_at: nil, expired_at: "2025-08-24 14:54:42.645777000 +0000", first_name: "Alice", last_name: "Brown", role: "employee", created_at: "2025-08-10 14:54:42.647989000 +0000", updated_at: "2025-08-10 14:54:42.647989000 +0000", client_id: nil, virtual_verified: false>]
+[#<Invitation:0x0000000305033fd8
+  id: 9,
+  company_id: 40,
+  sender_id: 22,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.645777000 +0000",
+  first_name: "Alice",
+  last_name: "Brown",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.647989000 +0000",
+  updated_at: "2025-08-10 14:54:42.647989000 +0000",
+  client_id: nil,
+  virtual_verified: false>,
+ #<Invitation:0x0000000305033d58
+  id: 10,
+  company_id: 40,
+  sender_id: 22,
+  recipient_email: [FILTERED],
+  token: [FILTERED],
+  accepted_at: nil,
+  expired_at: "2025-08-24 14:54:42.707527000 +0000",
+  first_name: "Bob",
+  last_name: "Green",
+  role: "employee",
+  created_at: "2025-08-10 14:54:42.714477000 +0000",
+  updated_at: "2025-08-10 14:54:42.714477000 +0000",
+  client_id: nil,
+  virtual_verified: false>]

RSpec::Retry: 3rd try ./spec/models/concerns/pg_searchable_spec.rb:177
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....F............................/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
.../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....************************************************************************
Warning from shoulda-matchers:

You are using `validate_inclusion_of` to assert that a boolean column
allows boolean values and disallows non-boolean ones. Be aware that it
is not possible to fully test this, as boolean columns will
automatically convert non-boolean values to boolean ones. Hence, you
should consider removing this test.
************************************************************************
...../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
...../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
...../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......................../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
........................................................./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
........../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
......./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
...............
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:53:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:53
......
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:53:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:53
..F...
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:63:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:63
...
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:63:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:63
...F...
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:74:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:74
..
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:74:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:74
....F...
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:86:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:86

2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:86:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:86
...F
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:97:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:97
..
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:97:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:97
...F.
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:107:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:107
.
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:107:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:107
..F
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:118:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:118
..
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:118:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:118
F...
1st Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:129:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:129
.
2nd Try error in ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:129:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:129
F...............
1st Try error in ./spec/models/invoice_spec.rb:152:
To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`

RSpec::Retry: 2nd try ./spec/models/invoice_spec.rb:152

2nd Try error in ./spec/models/invoice_spec.rb:152:
To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`
RSpec::Retry: 3rd try ./spec/models/invoice_spec.rb:152
F...................../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
........../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
.../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
............................................
1st Try error in ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:40:
To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:40
.....................
2nd Try error in ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:40:
To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:40

1st Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:96:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:96
.....
2nd Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:96:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:96
.....F
1st Try error in ./spec/requests/internal_api/v1/invoices/index_spec.rb:139:
expected collection contained:  [125]
actual collection contained:    [125, 126, 127, 128, 129, 130, 131, 132, 133, 134]
the extra elements were:        [126, 127, 128, 129, 130, 131, 132, 133, 134]


RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/invoices/index_spec.rb:139
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..F/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..
1st Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:100:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:100
.......
2nd Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:100:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:100

2nd Try error in ./spec/requests/internal_api/v1/invoices/index_spec.rb:139:
expected collection contained:  [135]
actual collection contained:    [135, 136, 137, 138, 139, 140, 141, 142, 143, 144]
the extra elements were:        [136, 137, 138, 139, 140, 141, 142, 143, 144]

RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/invoices/index_spec.rb:139
....F.
1st Try error in ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:47:
To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:47
.
1st Try error in ./spec/services/reports/time_entries/download_service_spec.rb:32:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/services/reports/time_entries/download_service_spec.rb:32

1st Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:110:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:110
F...
2nd Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:110:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:110
...
2nd Try error in ./spec/services/reports/time_entries/download_service_spec.rb:32:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/services/reports/time_entries/download_service_spec.rb:32
.
2nd Try error in ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:47:
To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:47
..F..
1st Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:125:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:125
....F.
2nd Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:125:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:125
..F/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..F.....
1st Try error in ./spec/services/reports/time_entries/download_service_spec.rb:39:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/services/reports/time_entries/download_service_spec.rb:39
.
1st Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:39:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:39

1st Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:129:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:129
.
2nd Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:39:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:39
..F
2nd Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:129:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:129
...
1st Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:50:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:50
.
2nd Try error in ./spec/services/reports/time_entries/download_service_spec.rb:39:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/services/reports/time_entries/download_service_spec.rb:39
.
2nd Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:50:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:50
F....F...
1st Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:61:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:61
...
2nd Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:61:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:61
.F
1st Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:162:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:162
.F..
1st Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:84:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:84
.
2nd Try error in ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:162:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:162
...
2nd Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:84:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:84
..FF
1st Try error in ./spec/services/reports/time_entries/download_service_spec.rb:44:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/services/reports/time_entries/download_service_spec.rb:44
.
1st Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:95:
undefined method 'search_index' for class TimesheetEntry

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:95
...
1st Try error in ./spec/requests/internal_api/v1/invoices/index_spec.rb:213:
expected collection contained:  [215, 218, 219, 220, 221]
actual collection contained:    [215, 216, 217, 218, 219, 220, 221, 222, 223, 224]
the extra elements were:        [216, 217, 222, 223, 224]


RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/invoices/index_spec.rb:213

2nd Try error in ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:95:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:95
......
2nd Try error in ./spec/services/reports/time_entries/download_service_spec.rb:44:
undefined method 'search_index' for class TimesheetEntry
RSpec::Retry: 3rd try ./spec/services/reports/time_entries/download_service_spec.rb:44
F...../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..
2nd Try error in ./spec/requests/internal_api/v1/invoices/index_spec.rb:213:
expected collection contained:  [225, 226, 227, 228, 231, 234]
actual collection contained:    [225, 226, 227, 228, 229, 230, 231, 232, 233, 234]
the extra elements were:        [229, 230, 232, 233]

RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/invoices/index_spec.rb:213
..........F......./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
.F/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:64:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:64
............
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:64:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:64
..............F............
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:68:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:68
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
...
1st Try error in ./spec/system/clients/hours_logged_spec.rb:28:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/hours_logged_spec.rb:28
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:68:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:68
.
2nd Try error in ./spec/system/clients/hours_logged_spec.rb:28:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/hours_logged_spec.rb:28
..
1st Try error in ./spec/requests/internal_api/v1/invoices/index_spec.rb:276:

expected: {"currency" => "DJF", "draftAmount" => "486688.8", "outstandingAmount" => 0, "overdueAmount" => 0}
     got: {"currency" => "DJF", "draftAmount" => "486688.8", "outstandingAmount" => "0.0", "overdueAmount" => "0.0", "paidAmount" => "0.0"}

(compared using ==)

Diff:
@@ -1,4 +1,5 @@
 "currency" => "DJF",
 "draftAmount" => "486688.8",
-"outstandingAmount" => 0,
-"overdueAmount" => 0,
+"outstandingAmount" => "0.0",
+"overdueAmount" => "0.0",
+"paidAmount" => "0.0",


RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/invoices/index_spec.rb:276
........F.F........
2nd Try error in ./spec/requests/internal_api/v1/invoices/index_spec.rb:276:

expected: {"currency" => "EEK", "draftAmount" => "565868.1", "outstandingAmount" => 0, "overdueAmount" => 0}
     got: {"currency" => "EEK", "draftAmount" => "565868.1", "outstandingAmount" => "0.0", "overdueAmount" => "0.0", "paidAmount" => "0.0"}

(compared using ==)

Diff:
@@ -1,4 +1,5 @@
 "currency" => "EEK",
 "draftAmount" => "565868.1",
-"outstandingAmount" => 0,
-"overdueAmount" => 0,
+"outstandingAmount" => "0.0",
+"overdueAmount" => "0.0",
+"paidAmount" => "0.0",

RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/invoices/index_spec.rb:276
....
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:72:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:72

1st Try error in ./spec/system/clients/hours_logged_spec.rb:46:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/hours_logged_spec.rb:46
...
1st Try error in ./spec/system/clients/delete_spec.rb:17:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/delete_spec.rb:17
...F....
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:72:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:72
..
2nd Try error in ./spec/system/clients/hours_logged_spec.rb:46:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/hours_logged_spec.rb:46

2nd Try error in ./spec/system/clients/delete_spec.rb:17:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/delete_spec.rb:17
....F.F.F...
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:76:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:76
...
1st Try error in ./spec/system/employment_details/edit_spec.rb:21:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/employment_details/edit_spec.rb:21

1st Try error in ./spec/system/clients/hours_logged_spec.rb:65:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/hours_logged_spec.rb:65
...
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:76:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:76
...
2nd Try error in ./spec/system/employment_details/edit_spec.rb:21:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/employment_details/edit_spec.rb:21

2nd Try error in ./spec/system/clients/hours_logged_spec.rb:65:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/hours_logged_spec.rb:65
F.....F.
1st Try error in ./spec/system/clients/due_invoice_payment_reminder_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/due_invoice_payment_reminder_spec.rb:19
.....
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:80:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:80
..F
...
Failures:

  1) Viewing hours logged by time frame when viewing hours logged for current week displays the correct totals for each client
     Got 0 failures and 2 other errors:

     1.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/hours_logged_spec.rb:17:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     1.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) Viewing hours logged by time frame when viewing hours logged for current month displays the correct totals for each client
     Got 0 failures and 2 other errors:

     2.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/hours_logged_spec.rb:17:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     2.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) Viewing hours logged by time frame when viewing hours logged for current year displays the correct totals for each client
     Got 0 failures and 2 other errors:

     3.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/hours_logged_spec.rb:17:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     3.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 11.44 seconds (files took 14.11 seconds to load)
183 examples, 3 failures

Failed examples:

rspec ./spec/system/clients/hours_logged_spec.rb:28 # Viewing hours logged by time frame when viewing hours logged for current week displays the correct totals for each client
rspec ./spec/system/clients/hours_logged_spec.rb:46 # Viewing hours logged by time frame when viewing hours logged for current month displays the correct totals for each client
rspec ./spec/system/clients/hours_logged_spec.rb:65 # Viewing hours logged by time frame when viewing hours logged for current year displays the correct totals for each client

.........
1st Try error in ./spec/system/employment_details/edit_spec.rb:36:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/employment_details/edit_spec.rb:36
...
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:80:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:80
....
1st Try error in ./spec/system/users/logout_spec.rb:16:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/logout_spec.rb:16

2nd Try error in ./spec/system/employment_details/edit_spec.rb:36:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/employment_details/edit_spec.rb:36
..F.....
2nd Try error in ./spec/system/users/logout_spec.rb:16:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/logout_spec.rb:16
..F
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:104:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:104
.....F

Pending: (Failures listed here are expected and do not affect your suite's status)

  1) PgSearchable Invoice search finds invoices by number
     # Temporarily skipped with xit
     # ./spec/models/concerns/pg_searchable_spec.rb:99
..
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:104:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:104

Failures:

  1) PgSearchable TimesheetEntry search finds entries by note
     Failure/Error: expect(results).not_to include(entry2)

       expected #<ActiveRecord::Relation [#<TimesheetEntry id: 5, user_id: 16, project_id: 8, duration: 480.0, note: ...97000 +0000", updated_at: "2025-08-10 14:54:42.120197000 +0000", discarded_at: nil, locked: false>]> not to include #<TimesheetEntry id: 6, user_id: 16, project_id: 8, duration: 480.0, note: "Bug fixing", work_date: "...0197000 +0000", updated_at: "2025-08-10 14:54:42.120197000 +0000", discarded_at: nil, locked: false>
       Diff:
       @@ -1 +1,24 @@
       -[#<TimesheetEntry id: 6, user_id: 16, project_id: 8, duration: 480.0, note: "Bug fixing", work_date: "2025-08-10", bill_status: "non_billable", created_at: "2025-08-10 14:54:42.120197000 +0000", updated_at: "2025-08-10 14:54:42.120197000 +0000", discarded_at: nil, locked: false>]
       +[#<TimesheetEntry:0x00000003045794d0
       +  id: 5,
       +  user_id: 16,
       +  project_id: 8,
       +  duration: 480.0,
       +  note: "Working on feature",
       +  work_date: "2025-08-10",
       +  bill_status: "non_billable",
       +  created_at: "2025-08-10 14:54:42.118172000 +0000",
       +  updated_at: "2025-08-10 14:54:42.118172000 +0000",
       +  discarded_at: nil,
       +  locked: false>,
       + #<TimesheetEntry:0x0000000304579390
       +  id: 6,
       +  user_id: 16,
       +  project_id: 8,
       +  duration: 480.0,
       +  note: "Bug fixing",
       +  work_date: "2025-08-10",
       +  bill_status: "non_billable",
       +  created_at: "2025-08-10 14:54:42.120197000 +0000",
       +  updated_at: "2025-08-10 14:54:42.120197000 +0000",
       +  discarded_at: nil,
       +  locked: false>]
     # ./spec/models/concerns/pg_searchable_spec.rb:128:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) PgSearchable Expense search finds expenses by description
     Failure/Error: expect(results).not_to include(expense1)

       expected #<ActiveRecord::Relation [#<Expense id: 5, date: "2025-07-11", amount: 0.1e3, expense_type: "personal...ated_at: "2025-08-10 14:54:42.277242000 +0000", updated_at: "2025-08-10 14:54:42.277242000 +0000">]> not to include #<Expense id: 5, date: "2025-07-11", amount: 0.1e3, expense_type: "personal", description: "Office su...reated_at: "2025-08-10 14:54:42.271240000 +0000", updated_at: "2025-08-10 14:54:42.271240000 +0000">
       Diff:
       @@ -1 +1,22 @@
       -[#<Expense id: 5, date: "2025-07-11", amount: 0.1e3, expense_type: "personal", description: "Office supplies", company_id: 30, expense_category_id: 3, vendor_id: nil, created_at: "2025-08-10 14:54:42.271240000 +0000", updated_at: "2025-08-10 14:54:42.271240000 +0000">]
       +[#<Expense:0x00000001690b1188
       +  id: 5,
       +  date: "2025-07-11",
       +  amount: 0.1e3,
       +  expense_type: "personal",
       +  description: "Office supplies",
       +  company_id: 30,
       +  expense_category_id: 3,
       +  vendor_id: nil,
       +  created_at: "2025-08-10 14:54:42.271240000 +0000",
       +  updated_at: "2025-08-10 14:54:42.271240000 +0000">,
       + #<Expense:0x00000001690b1048
       +  id: 6,
       +  date: "2025-06-21",
       +  amount: 0.5e3,
       +  expense_type: "business",
       +  description: "Software license",
       +  company_id: 30,
       +  expense_category_id: 3,
       +  vendor_id: 3,
       +  created_at: "2025-08-10 14:54:42.277242000 +0000",
       +  updated_at: "2025-08-10 14:54:42.277242000 +0000">]
     # ./spec/models/concerns/pg_searchable_spec.rb:153:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) PgSearchable Invitation search finds invitations by first name
     Failure/Error: expect(results).not_to include(invitation2)

       expected #<ActiveRecord::Relation [#<Invitation id: 5, company_id: 36, sender_id: 20, recipient_email: [FILTER...0000", updated_at: "2025-08-10 14:54:42.542718000 +0000", client_id: nil, virtual_verified: false>]> not to include #<Invitation id: 6, company_id: 36, sender_id: 20, recipient_email: [FILTERED], token: [FILTERED], ac... +0000", updated_at: "2025-08-10 14:54:42.542718000 +0000", client_id: nil, virtual_verified: false>
       Diff:
       @@ -1 +1,30 @@
       -[#<Invitation id: 6, company_id: 36, sender_id: 20, recipient_email: [FILTERED], token: [FILTERED], accepted_at: nil, expired_at: "2025-08-24 14:54:42.538994000 +0000", first_name: "Bob", last_name: "Green", role: "employee", created_at: "2025-08-10 14:54:42.542718000 +0000", updated_at: "2025-08-10 14:54:42.542718000 +0000", client_id: nil, virtual_verified: false>]
       +[#<Invitation:0x000000012e235008
       +  id: 5,
       +  company_id: 36,
       +  sender_id: 20,
       +  recipient_email: [FILTERED],
       +  token: [FILTERED],
       +  accepted_at: nil,
       +  expired_at: "2025-08-24 14:54:42.521800000 +0000",
       +  first_name: "Alice",
       +  last_name: "Brown",
       +  role: "employee",
       +  created_at: "2025-08-10 14:54:42.525184000 +0000",
       +  updated_at: "2025-08-10 14:54:42.525184000 +0000",
       +  client_id: nil,
       +  virtual_verified: false>,
       + #<Invitation:0x000000012e234d88
       +  id: 6,
       +  company_id: 36,
       +  sender_id: 20,
       +  recipient_email: [FILTERED],
       +  token: [FILTERED],
       +  accepted_at: nil,
       +  expired_at: "2025-08-24 14:54:42.538994000 +0000",
       +  first_name: "Bob",
       +  last_name: "Green",
       +  role: "employee",
       +  created_at: "2025-08-10 14:54:42.542718000 +0000",
       +  updated_at: "2025-08-10 14:54:42.542718000 +0000",
       +  client_id: nil,
       +  virtual_verified: false>]
     # ./spec/models/concerns/pg_searchable_spec.rb:174:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  4) PgSearchable Invitation search finds invitations by email
     Failure/Error: expect(results).not_to include(invitation1)

       expected #<ActiveRecord::Relation [#<Invitation id: 11, company_id: 42, sender_id: 23, recipient_email: [FILTE...0000", updated_at: "2025-08-10 14:54:42.779821000 +0000", client_id: nil, virtual_verified: false>]> not to include #<Invitation id: 11, company_id: 42, sender_id: 23, recipient_email: [FILTERED], token: [FILTERED], a... +0000", updated_at: "2025-08-10 14:54:42.766137000 +0000", client_id: nil, virtual_verified: false>
       Diff:
       @@ -1 +1,30 @@
       -[#<Invitation id: 11, company_id: 42, sender_id: 23, recipient_email: [FILTERED], token: [FILTERED], accepted_at: nil, expired_at: "2025-08-24 14:54:42.762791000 +0000", first_name: "Alice", last_name: "Brown", role: "employee", created_at: "2025-08-10 14:54:42.766137000 +0000", updated_at: "2025-08-10 14:54:42.766137000 +0000", client_id: nil, virtual_verified: false>]
       +[#<Invitation:0x0000000304c71198
       +  id: 11,
       +  company_id: 42,
       +  sender_id: 23,
       +  recipient_email: [FILTERED],
       +  token: [FILTERED],
       +  accepted_at: nil,
       +  expired_at: "2025-08-24 14:54:42.762791000 +0000",
       +  first_name: "Alice",
       +  last_name: "Brown",
       +  role: "employee",
       +  created_at: "2025-08-10 14:54:42.766137000 +0000",
       +  updated_at: "2025-08-10 14:54:42.766137000 +0000",
       +  client_id: nil,
       +  virtual_verified: false>,
       + #<Invitation:0x0000000304c71058
       +  id: 12,
       +  company_id: 42,
       +  sender_id: 23,
       +  recipient_email: [FILTERED],
       +  token: [FILTERED],
       +  accepted_at: nil,
       +  expired_at: "2025-08-24 14:54:42.776238000 +0000",
       +  first_name: "Bob",
       +  last_name: "Green",
       +  role: "employee",
       +  created_at: "2025-08-10 14:54:42.779821000 +0000",
       +  updated_at: "2025-08-10 14:54:42.779821000 +0000",
       +  client_id: nil,
       +  virtual_verified: false>]
     # ./spec/models/concerns/pg_searchable_spec.rb:181:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  5) Invoice.send_to_email sends the invoice on email
     Failure/Error: expect { invoice.send_to_email(subject:, recipients:, message:) }.to have_enqueued_mail(InvoiceMailer, :invoice)

     StandardError:
       To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`
     # ./spec/models/invoice_spec.rb:153:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  6) InternalApi::V1::Reports::TimeEntryController#download when user is an admin or owner when CSV file requested returns CSV data in response
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  7) InternalApi::V1::Reports::TimeEntryController#download when user is an admin or owner when pdf file requested generates PDF and send in response
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  8) InternalApi::V1::Reports::TimeEntryController#download when user is an employee returns 403 status
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  9) InternalApi::V1::Reports::TimeEntryController#download when user is a book keeper when CSV file requested returns CSV data in response
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  10) InternalApi::V1::Reports::TimeEntryController#download when user is a book keeper when pdf file requested generates PDF and send in response
      Failure/Error: TimesheetEntry.search_index.refresh

      NoMethodError:
        undefined method 'search_index' for class TimesheetEntry
      # ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:20:in 'block (2 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  11) Logout when user want to logout logout the current user when user clicks on logout
      Got 0 failures and 2 other errors:

      11.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/users/logout_spec.rb:13:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      11.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 11.97 seconds (files took 14.24 seconds to load)
183 examples, 11 failures, 1 pending

Failed examples:

rspec ./spec/models/concerns/pg_searchable_spec.rb:124 # PgSearchable TimesheetEntry search finds entries by note
rspec ./spec/models/concerns/pg_searchable_spec.rb:149 # PgSearchable Expense search finds expenses by description
rspec ./spec/models/concerns/pg_searchable_spec.rb:170 # PgSearchable Invitation search finds invitations by first name
rspec ./spec/models/concerns/pg_searchable_spec.rb:177 # PgSearchable Invitation search finds invitations by email
rspec ./spec/models/invoice_spec.rb:152 # Invoice.send_to_email sends the invoice on email
rspec ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:39 # InternalApi::V1::Reports::TimeEntryController#download when user is an admin or owner when CSV file requested returns CSV data in response
rspec ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:50 # InternalApi::V1::Reports::TimeEntryController#download when user is an admin or owner when pdf file requested generates PDF and send in response
rspec ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:61 # InternalApi::V1::Reports::TimeEntryController#download when user is an employee returns 403 status
rspec ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:84 # InternalApi::V1::Reports::TimeEntryController#download when user is a book keeper when CSV file requested returns CSV data in response
rspec ./spec/requests/internal_api/v1/reports/time_entry/download_spec.rb:95 # InternalApi::V1::Reports::TimeEntryController#download when user is a book keeper when pdf file requested generates PDF and send in response
rspec ./spec/system/users/logout_spec.rb:16 # Logout when user want to logout logout the current user when user clicks on logout

.../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
Duration can't be blank
....F/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
Duration can't be blank
.......
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:108:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:108
....
2nd Try error in ./spec/system/clients/due_invoice_payment_reminder_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/due_invoice_payment_reminder_spec.rb:19

1st Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/send_invoice.rb:6
....
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:108:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:108
.......F.....
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:123:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:123
.....
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:123:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:123

2nd Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/send_invoice.rb:6
...F....
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:127:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:127
....
2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:127:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:127
FF
1st Try error in ./spec/system/payments/index_spec.rb:22:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/payments/index_spec.rb:22
F
2nd Try error in ./spec/system/payments/index_spec.rb:22:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/payments/index_spec.rb:22
.F
1st Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:159:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:159

2nd Try error in ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:159:
undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:159

1st Try error in ./spec/system/teams/index_spec.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/index_spec.rb:20

1st Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/send_invoice.rb:20
F
2nd Try error in ./spec/system/teams/index_spec.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/index_spec.rb:20
../Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.

1st Try error in ./spec/system/clients/overdue_and_outstanding_calucluation_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/overdue_and_outstanding_calucluation_spec.rb:19
..F./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
.
1st Try error in ./spec/system/clients/due_invoice_payment_reminder_spec.rb:32:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/due_invoice_payment_reminder_spec.rb:32
..
1st Try error in ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6:
uninitialized constant InternalApi::V1::TimezonesController::ISO3166

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6

2nd Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/send_invoice.rb:20

2nd Try error in ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6:
uninitialized constant InternalApi::V1::TimezonesController::ISO3166
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6
F
1st Try error in ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6:
uninitialized constant InternalApi::V1::TimezonesController::ISO3166

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6

1st Try error in ./spec/system/teams/index_spec.rb:42:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/index_spec.rb:42

2nd Try error in ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6:
uninitialized constant InternalApi::V1::TimezonesController::ISO3166
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6
F
1st Try error in ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6:
uninitialized constant InternalApi::V1::TimezonesController::ISO3166

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6

2nd Try error in ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6:
uninitialized constant InternalApi::V1::TimezonesController::ISO3166
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/timezones_controller_spec.rb:6
F.F
2nd Try error in ./spec/system/teams/index_spec.rb:42:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/index_spec.rb:42
...
2nd Try error in ./spec/system/clients/overdue_and_outstanding_calucluation_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/overdue_and_outstanding_calucluation_spec.rb:19
.
2nd Try error in ./spec/system/clients/due_invoice_payment_reminder_spec.rb:32:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/due_invoice_payment_reminder_spec.rb:32
.F.
1st Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/send_invoice.rb:6
..
1st Try error in ./spec/system/teams/index_spec.rb:54:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/index_spec.rb:54
..
1st Try error in ./spec/requests/invoices/payments_controller_spec.rb:83:
undefined method 'react_component' for an instance of #<Class:0x000000013e898c00>

RSpec::Retry: 2nd try ./spec/requests/invoices/payments_controller_spec.rb:83

2nd Try error in ./spec/requests/invoices/payments_controller_spec.rb:83:
undefined method 'react_component' for an instance of #<Class:0x000000013e898c00>
RSpec::Retry: 3rd try ./spec/requests/invoices/payments_controller_spec.rb:83
F
2nd Try error in ./spec/system/teams/index_spec.rb:54:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/index_spec.rb:54

2nd Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/send_invoice.rb:6

1st Try error in ./spec/requests/invoices/payments_controller_spec.rb:95:
Shakapacker can't find application.css in /Users/sward/saeloun/miru-web/public/packs-test/manifest.json. Possible causes:
1. You forgot to install javascript packages or are running an incompatible javascript runtime version
2. Your app has code with a non-standard extension (like a `.jsx` file) but the extension is not in the `extensions` config in `config/shakapacker.yml`
3. You have set compile: false (see `config/shakapacker.yml`) for this environment
   (unless you are using the `bin/shakapacker -w` or the `bin/shakapacker-dev-server`, in which case maybe you aren't running the dev server in the background?)
4. webpack has not yet FINISHED running to reflect updates.
5. You have misconfigured Shakapacker's `config/shakapacker.yml` file.
6. Your webpack configuration is not creating a manifest.

Your manifest contains:
{
  "entrypoints": {}
}


RSpec::Retry: 2nd try ./spec/requests/invoices/payments_controller_spec.rb:95

2nd Try error in ./spec/requests/invoices/payments_controller_spec.rb:95:
Shakapacker can't find application.css in /Users/sward/saeloun/miru-web/public/packs-test/manifest.json. Possible causes:
1. You forgot to install javascript packages or are running an incompatible javascript runtime version
2. Your app has code with a non-standard extension (like a `.jsx` file) but the extension is not in the `extensions` config in `config/shakapacker.yml`
3. You have set compile: false (see `config/shakapacker.yml`) for this environment
   (unless you are using the `bin/shakapacker -w` or the `bin/shakapacker-dev-server`, in which case maybe you aren't running the dev server in the background?)
4. webpack has not yet FINISHED running to reflect updates.
5. You have misconfigured Shakapacker's `config/shakapacker.yml` file.
6. Your webpack configuration is not creating a manifest.

Your manifest contains:
{
  "entrypoints": {}
}

RSpec::Retry: 3rd try ./spec/requests/invoices/payments_controller_spec.rb:95
FF.F......[WARNING] The default currency will change from `USD` to `nil` in the next major release. Make sure to set it explicitly using `Money.default_currency=` to avoid potential issues
......F....
1st Try error in ./spec/system/teams/index_spec.rb:69:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/index_spec.rb:69
F
1st Try error in ./spec/system/clients/search_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/search_spec.rb:18

2nd Try error in ./spec/system/teams/index_spec.rb:69:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/index_spec.rb:69

2nd Try error in ./spec/system/clients/search_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/search_spec.rb:18

1st Try error in ./spec/system/shared_examples/invoices/invoice_history.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/invoice_history.rb:6
F
1st Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/send_invoice.rb:20

1st Try error in ./spec/system/clients/search_spec.rb:30:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/search_spec.rb:30
F
2nd Try error in ./spec/system/shared_examples/invoices/invoice_history.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/invoice_history.rb:6

2nd Try error in ./spec/system/clients/search_spec.rb:30:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/search_spec.rb:30

1st Try error in ./spec/system/clients/due_invoice_payment_reminder_spec.rb:46:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/clients/due_invoice_payment_reminder_spec.rb:46
F
1st Try error in ./spec/system/teams/index_spec.rb:80:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/index_spec.rb:80

2nd Try error in ./spec/system/shared_examples/invoices/send_invoice.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/send_invoice.rb:20

1st Try error in ./spec/system/companies/index_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/companies/index_spec.rb:19

2nd Try error in ./spec/system/companies/index_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/companies/index_spec.rb:19
F
2nd Try error in ./spec/system/teams/index_spec.rb:80:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/index_spec.rb:80
FF
1st Try error in ./spec/system/teams/edit_spec.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/edit_spec.rb:20
F
1st Try error in ./spec/system/shared_examples/invoices/invoice_history.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/invoice_history.rb:6

2nd Try error in ./spec/system/teams/edit_spec.rb:20:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/edit_spec.rb:20

2nd Try error in ./spec/system/clients/due_invoice_payment_reminder_spec.rb:46:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/clients/due_invoice_payment_reminder_spec.rb:46

1st Try error in ./spec/system/time_tracking/week_view_spec.rb:14:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/week_view_spec.rb:14
F
2nd Try error in ./spec/system/time_tracking/week_view_spec.rb:14:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/week_view_spec.rb:14

1st Try error in ./spec/system/invoices/send_invoice_spec.rb:45:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/invoices/send_invoice_spec.rb:45

1st Try error in ./spec/system/teams/edit_spec.rb:34:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/teams/edit_spec.rb:34

2nd Try error in ./spec/system/shared_examples/invoices/invoice_history.rb:6:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/invoice_history.rb:6
F
2nd Try error in ./spec/system/teams/edit_spec.rb:34:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/teams/edit_spec.rb:34

1st Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:25:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/time_tracking/week_view.rb:25
F

Pending: (Failures listed here are expected and do not affect your suite's status)

  1) Client search functionality Client.search with associated data includes associations when specified
     # Temporarily skipped with xit
     # ./spec/models/client_search_spec.rb:134

  2) Client search functionality Client.search field-specific search searches only in name field
     # Temporarily skipped with xit
     # ./spec/models/client_search_spec.rb:142

  3) Client search functionality Client.search field-specific search searches only in email field
     # Temporarily skipped with xit
     # ./spec/models/client_search_spec.rb:151

2nd Try error in ./spec/system/invoices/send_invoice_spec.rb:45:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/invoices/send_invoice_spec.rb:45

Failures:

  1) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the 200 http response
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:59:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  2) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the billable clients data in alaphabetical order with amount details
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:59:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  3) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made does not return non billable clients data
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:59:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  4) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the base currency
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:59:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  5) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the summary of all clients
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:59:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  6) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the 200 http response
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:99:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  7) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the clients data in alaphabetical order with amount details
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:99:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  8) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the base currency
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:99:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  9) InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the summary of first client
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.paid_amount client[:paid_amount]
         json.outstanding_amount client[:outstanding_amount]
         json.overdue_amount client[:overdue_amount]
         json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
       end

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
     # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
     # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:99:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
     #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  10) InternalApi::V1::Reports::ClientRevenuesController::#index when user is a book keeper is permitted to view client revenue report
      Failure/Error:
        json.clients clients do |client|
          json.name client[:name]
          json.logo client[:logo]
          json.paid_amount client[:paid_amount]
          json.outstanding_amount client[:outstanding_amount]
          json.overdue_amount client[:overdue_amount]
          json.total_amount client[:paid_amount] + client[:outstanding_amount] + client[:overdue_amount]
        end

      ActionView::Template::Error:
        undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
      # ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'
      # ./app/controllers/internal_api/v1/reports/client_revenues_controller.rb:7:in 'InternalApi::V1::Reports::ClientRevenuesController#index'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:156:in 'block (3 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NameError:
      #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013e8f3218>
      #   ./app/views/internal_api/v1/reports/client_revenues/index.json.jbuilder:6:in '_app_views_internal_api_v__reports_client_revenues_index_json_jbuilder___1338140551566391380_63432'

  11) InternalApi::V1::TimezonesController GET index when user is an admin behaves like InternalApi::V1::TimezonesController index returns timezones in response
      Failure/Error:
        timezones = ISO3166::Country.pluck(:alpha2).flatten.reduce(Hash.new([])) do |obj, alpha|
          obj[alpha] = ActiveSupport::TimeZone.country_zones(alpha).map(&:to_s)
          obj
        end

      NameError:
        uninitialized constant InternalApi::V1::TimezonesController::ISO3166
      Shared Example Group: "InternalApi::V1::TimezonesController index" called from ./spec/requests/internal_api/v1/timezones_controller_spec.rb:35
      # ./app/controllers/internal_api/v1/timezones_controller.rb:9:in 'InternalApi::V1::TimezonesController#index'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/internal_api/v1/timezones_controller_spec.rb:33:in 'block (4 levels) in <top (required)>'
      # ./spec/requests/internal_api/v1/timezones_controller_spec.rb:7:in 'block (2 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  12) InternalApi::V1::TimezonesController GET index when user is an employee behaves like InternalApi::V1::TimezonesController index returns timezones in response
      Failure/Error:
        timezones = ISO3166::Country.pluck(:alpha2).flatten.reduce(Hash.new([])) do |obj, alpha|
          obj[alpha] = ActiveSupport::TimeZone.country_zones(alpha).map(&:to_s)
          obj
        end

      NameError:
        uninitialized constant InternalApi::V1::TimezonesController::ISO3166
      Shared Example Group: "InternalApi::V1::TimezonesController index" called from ./spec/requests/internal_api/v1/timezones_controller_spec.rb:43
      # ./app/controllers/internal_api/v1/timezones_controller.rb:9:in 'InternalApi::V1::TimezonesController#index'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/internal_api/v1/timezones_controller_spec.rb:41:in 'block (4 levels) in <top (required)>'
      # ./spec/requests/internal_api/v1/timezones_controller_spec.rb:7:in 'block (2 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  13) InternalApi::V1::TimezonesController GET index when user is a book_keeper behaves like InternalApi::V1::TimezonesController index returns timezones in response
      Failure/Error:
        timezones = ISO3166::Country.pluck(:alpha2).flatten.reduce(Hash.new([])) do |obj, alpha|
          obj[alpha] = ActiveSupport::TimeZone.country_zones(alpha).map(&:to_s)
          obj
        end

      NameError:
        uninitialized constant InternalApi::V1::TimezonesController::ISO3166
      Shared Example Group: "InternalApi::V1::TimezonesController index" called from ./spec/requests/internal_api/v1/timezones_controller_spec.rb:51
      # ./app/controllers/internal_api/v1/timezones_controller.rb:9:in 'InternalApi::V1::TimezonesController#index'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/internal_api/v1/timezones_controller_spec.rb:49:in 'block (4 levels) in <top (required)>'
      # ./spec/requests/internal_api/v1/timezones_controller_spec.rb:7:in 'block (2 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  14) Invoices::PaymentsController GET success doesn't mark invoice status as paid
      Failure/Error: <%= react_component("App", get_initial_props) %>

      ActionView::Template::Error:
        undefined method 'react_component' for an instance of #<Class:0x000000013e898c00>
      # ./app/views/home/index.html.erb:1:in '_app_views_home_index_html_erb__329103434415520074_82856'
      # ./app/controllers/home_controller.rb:12:in 'HomeController#index'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/invoices/payments_controller_spec.rb:81:in 'block (3 levels) in <top (required)>'
      # ./spec/requests/invoices/payments_controller_spec.rb:85:in 'block (3 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NoMethodError:
      #   undefined method 'react_component' for an instance of #<Class:0x000000013e898c00>
      #   ./app/views/home/index.html.erb:1:in '_app_views_home_index_html_erb__329103434415520074_82856'

  15) Invoices::PaymentsController GET cancel renders time tracking page with status 200
      Failure/Error: <%= stylesheet_pack_tag "application" %>

      ActionView::Template::Error:
        Shakapacker can't find application.css in /Users/sward/saeloun/miru-web/public/packs-test/manifest.json. Possible causes:
        1. You forgot to install javascript packages or are running an incompatible javascript runtime version
        2. Your app has code with a non-standard extension (like a `.jsx` file) but the extension is not in the `extensions` config in `config/shakapacker.yml`
        3. You have set compile: false (see `config/shakapacker.yml`) for this environment
           (unless you are using the `bin/shakapacker -w` or the `bin/shakapacker-dev-server`, in which case maybe you aren't running the dev server in the background?)
        4. webpack has not yet FINISHED running to reflect updates.
        5. You have misconfigured Shakapacker's `config/shakapacker.yml` file.
        6. Your webpack configuration is not creating a manifest.

        Your manifest contains:
        {
          "entrypoints": {}
        }
      # ./app/views/layouts/application.html.erb:16:in '_app_views_layouts_application_html_erb___815333226372611664_82864'
      # ./app/controllers/invoices/payments_controller.rb:19:in 'Invoices::PaymentsController#cancel'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/invoices/payments_controller_spec.rb:93:in 'block (3 levels) in <top (required)>'
      # ./spec/requests/invoices/payments_controller_spec.rb:96:in 'block (3 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # Shakapacker::Manifest::MissingEntryError:
      #   Shakapacker can't find application.css in /Users/sward/saeloun/miru-web/public/packs-test/manifest.json. Possible causes:
      #   1. You forgot to install javascript packages or are running an incompatible javascript runtime version
      #   2. Your app has code with a non-standard extension (like a `.jsx` file) but the extension is not in the `extensions` config in `config/shakapacker.yml`
      #   3. You have set compile: false (see `config/shakapacker.yml`) for this environment
      #      (unless you are using the `bin/shakapacker -w` or the `bin/shakapacker-dev-server`, in which case maybe you aren't running the dev server in the background?)
      #   4. webpack has not yet FINISHED running to reflect updates.
      #   5. You have misconfigured Shakapacker's `config/shakapacker.yml` file.
      #   6. Your webpack configuration is not creating a manifest.
      #
      #   Your manifest contains:
      #   {
      #     "entrypoints": {}
      #   }
      #   ./app/views/layouts/application.html.erb:16:in '_app_views_layouts_application_html_erb___815333226372611664_82864'

  16) Search clients when searching for a client displays the matching client in the list
      Got 0 failures and 2 other errors:

      16.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/clients/search_spec.rb:14:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      16.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  17) Search clients when searching for a client displays a message when no match is found
      Got 0 failures and 2 other errors:

      17.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/clients/search_spec.rb:14:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      17.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  18) Companies index page when user is an admin returns the list of company's clients and company info
      Got 0 failures and 2 other errors:

      18.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/companies/index_spec.rb:16:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      18.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  19) Editing team member details when user is an admin when editing team member can edit a team member name
      Got 0 failures and 2 other errors:

      19.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/teams/edit_spec.rb:16:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      19.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  20) Editing team member details when user is an admin when editing team member can edit a team member role
      Got 0 failures and 2 other errors:

      20.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/teams/edit_spec.rb:16:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      20.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 22.18 seconds (files took 13.98 seconds to load)
161 examples, 20 failures, 3 pending

Failed examples:

rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:64 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the 200 http response
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:68 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the billable clients data in alaphabetical order with amount details
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:72 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made does not return non billable clients data
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:76 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the base currency
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:80 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made returns the summary of all clients
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:104 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the 200 http response
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:108 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the clients data in alaphabetical order with amount details
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:123 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the base currency
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:127 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is an admin when reports page's request is made with client_ids returns the summary of first client
rspec ./spec/requests/internal_api/v1/reports/client_revenue/index_spec.rb:159 # InternalApi::V1::Reports::ClientRevenuesController::#index when user is a book keeper is permitted to view client revenue report
rspec './spec/requests/internal_api/v1/timezones_controller_spec.rb[1:1:1:1:1]' # InternalApi::V1::TimezonesController GET index when user is an admin behaves like InternalApi::V1::TimezonesController index returns timezones in response
rspec './spec/requests/internal_api/v1/timezones_controller_spec.rb[1:1:2:1:1]' # InternalApi::V1::TimezonesController GET index when user is an employee behaves like InternalApi::V1::TimezonesController index returns timezones in response
rspec './spec/requests/internal_api/v1/timezones_controller_spec.rb[1:1:3:1:1]' # InternalApi::V1::TimezonesController GET index when user is a book_keeper behaves like InternalApi::V1::TimezonesController index returns timezones in response
rspec ./spec/requests/invoices/payments_controller_spec.rb:83 # Invoices::PaymentsController GET success doesn't mark invoice status as paid
rspec ./spec/requests/invoices/payments_controller_spec.rb:95 # Invoices::PaymentsController GET cancel renders time tracking page with status 200
rspec ./spec/system/clients/search_spec.rb:18 # Search clients when searching for a client displays the matching client in the list
rspec ./spec/system/clients/search_spec.rb:30 # Search clients when searching for a client displays a message when no match is found
rspec ./spec/system/companies/index_spec.rb:19 # Companies index page when user is an admin returns the list of company's clients and company info
rspec ./spec/system/teams/edit_spec.rb:20 # Editing team member details when user is an admin when editing team member can edit a team member name
rspec ./spec/system/teams/edit_spec.rb:34 # Editing team member details when user is an admin when editing team member can edit a team member role


2nd Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:25:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/time_tracking/week_view.rb:25
FFF
1st Try error in ./spec/system/employment_details/index_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/employment_details/index_spec.rb:19
F
2nd Try error in ./spec/system/employment_details/index_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/employment_details/index_spec.rb:19

1st Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:37:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/time_tracking/week_view.rb:37

1st Try error in ./spec/system/invoices/invoice_history_spec.rb:45:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/invoices/invoice_history_spec.rb:45
F
1st Try error in ./spec/system/projects/add_team_member_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/add_team_member_spec.rb:19

2nd Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:37:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/time_tracking/week_view.rb:37

1st Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:6:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/generate_invoice.rb:6

2nd Try error in ./spec/system/projects/add_team_member_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/add_team_member_spec.rb:19
F
2nd Try error in ./spec/system/invoices/invoice_history_spec.rb:45:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/invoices/invoice_history_spec.rb:45

2nd Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:6:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/generate_invoice.rb:6
F
1st Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:58:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/time_tracking/week_view.rb:58
F
1st Try error in ./spec/system/projects/add_team_member_spec.rb:47:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/add_team_member_spec.rb:47

2nd Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:58:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/time_tracking/week_view.rb:58
F
1st Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:20:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/generate_invoice.rb:20

2nd Try error in ./spec/system/projects/add_team_member_spec.rb:47:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/add_team_member_spec.rb:47
F
1st Try error in ./spec/system/payments/create_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/payments/create_spec.rb:18

2nd Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:20:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/generate_invoice.rb:20
F
2nd Try error in ./spec/system/payments/create_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/payments/create_spec.rb:18

1st Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:25:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/time_tracking/week_view.rb:25
FF
1st Try error in ./spec/system/projects/add_team_member_spec.rb:62:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/add_team_member_spec.rb:62

2nd Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:25:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/time_tracking/week_view.rb:25

1st Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:6:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/generate_invoice.rb:6

1st Try error in ./spec/system/payments/create_spec.rb:47:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/payments/create_spec.rb:47

2nd Try error in ./spec/system/projects/add_team_member_spec.rb:62:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/add_team_member_spec.rb:62
F
2nd Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:6:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/generate_invoice.rb:6

2nd Try error in ./spec/system/payments/create_spec.rb:47:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/payments/create_spec.rb:47

1st Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:37:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/time_tracking/week_view.rb:37
FFF

Failures:

  1) SendWeeklyReminderToUserMailer notify_user_about_missed_entries add mail to default queue
     Failure/Error: expect { mailer.deliver_later }.to have_enqueued_job.on_queue("default").exactly(:once)

     StandardError:
       To use ActiveJob matchers set `ActiveJob::Base.queue_adapter = :test`
     # ./spec/mailers/send_weekly_reminder_to_user_mailer_spec.rb:20:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) InternalApi::V1::Invoices#send_invoice when user is signed in when user is an admin enqueues an email for delivery
     Failure/Error:
       expect do
         post send_invoice_internal_api_v1_invoice_path(id: invoice.id), params: { invoice_email: },
           headers: auth_headers(user)
       end.to have_enqueued_mail(InvoiceMailer, :invoice)

     StandardError:
       To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`
     # ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:44:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) InternalApi::V1::Invoices#send_invoice when user is signed in when user is an admin changes time_sheet_entries status to billed
     Failure/Error:
       expect do
         post send_invoice_internal_api_v1_invoice_path(id: invoice.id), params: { invoice_email: },
           headers: auth_headers(user)
       end.to have_enqueued_mail(InvoiceMailer, :invoice)

     StandardError:
       To use HaveEnqueuedMail matcher set `ActiveJob::Base.queue_adapter = :test`
     # ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:51:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  4) Client overdue and outstanding calculation calculates overdue and outstanding amounts correctly
     Got 0 failures and 2 other errors:

     4.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/overdue_and_outstanding_calucluation_spec.rb:16:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     4.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  5) View Invoice Logs when logged-in user is Admin is able to view Invoices logs panel
     Got 0 failures and 2 other errors:
     Shared Example Group: "View Invoice Logs" called from ./spec/system/invoices/invoice_history_spec.rb:29

     5.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/invoices/invoice_history_spec.rb:26:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     5.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  6) View Invoice Logs when logged-in 2user is Owner is able to view Invoices logs panel
     Got 0 failures and 2 other errors:
     Shared Example Group: "View Invoice Logs" called from ./spec/system/invoices/invoice_history_spec.rb:37

     6.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/invoices/invoice_history_spec.rb:34:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     6.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  7) View Invoice Logs when logged-in user is Employee is not able to see invoices option
     Got 0 failures and 2 other errors:

     7.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/invoices/invoice_history_spec.rb:42:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     7.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  8) Adding payment entry when user is an admin creates a payment entry successfully
     Got 0 failures and 2 other errors:

     8.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/payments/create_spec.rb:15:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     8.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  9) Adding payment entry when user is an employee does not have payments link
     Got 0 failures and 2 other errors:

     9.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/payments/create_spec.rb:44:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     9.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 25.46 seconds (files took 14.19 seconds to load)
151 examples, 9 failures

Failed examples:

rspec ./spec/mailers/send_weekly_reminder_to_user_mailer_spec.rb:12 # SendWeeklyReminderToUserMailer notify_user_about_missed_entries add mail to default queue
rspec ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:40 # InternalApi::V1::Invoices#send_invoice when user is signed in when user is an admin enqueues an email for delivery
rspec ./spec/requests/internal_api/v1/invoices/send_invoice_spec.rb:47 # InternalApi::V1::Invoices#send_invoice when user is signed in when user is an admin changes time_sheet_entries status to billed
rspec ./spec/system/clients/overdue_and_outstanding_calucluation_spec.rb:19 # Client overdue and outstanding calculation calculates overdue and outstanding amounts correctly
rspec ./spec/system/invoices/invoice_history_spec.rb:24 # View Invoice Logs when logged-in user is Admin is able to view Invoices logs panel
rspec ./spec/system/invoices/invoice_history_spec.rb:32 # View Invoice Logs when logged-in 2user is Owner is able to view Invoices logs panel
rspec ./spec/system/invoices/invoice_history_spec.rb:45 # View Invoice Logs when logged-in user is Employee is not able to see invoices option
rspec ./spec/system/payments/create_spec.rb:18 # Adding payment entry when user is an admin creates a payment entry successfully
rspec ./spec/system/payments/create_spec.rb:47 # Adding payment entry when user is an employee does not have payments link


2nd Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:37:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/time_tracking/week_view.rb:37

1st Try error in ./spec/system/projects/delete_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/delete_spec.rb:18

1st Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:20:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/invoices/generate_invoice.rb:20
F
2nd Try error in ./spec/system/projects/delete_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/delete_spec.rb:18

2nd Try error in ./spec/system/shared_examples/invoices/generate_invoice.rb:20:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/invoices/generate_invoice.rb:20
F
1st Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:58:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/shared_examples/time_tracking/week_view.rb:58
F
2nd Try error in ./spec/system/shared_examples/time_tracking/week_view.rb:58:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/shared_examples/time_tracking/week_view.rb:58

1st Try error in ./spec/system/projects/edit_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/edit_spec.rb:18

1st Try error in ./spec/system/invoices/generate_invoice_spec.rb:57:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/invoices/generate_invoice_spec.rb:57
F
2nd Try error in ./spec/system/projects/edit_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/edit_spec.rb:18

2nd Try error in ./spec/system/invoices/generate_invoice_spec.rb:57:
Validation failed: You can't create an unbilled entry for non-billable projects
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/invoices/generate_invoice_spec.rb:57
F
1st Try error in ./spec/system/users/login_spec.rb:15:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/login_spec.rb:15
F
1st Try error in ./spec/system/users/email_confirmations_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/email_confirmations_spec.rb:19

2nd Try error in ./spec/system/users/login_spec.rb:15:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/login_spec.rb:15

1st Try error in ./spec/system/users/reset_password_spec.rb:10:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/reset_password_spec.rb:10

2nd Try error in ./spec/system/users/email_confirmations_spec.rb:19:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/email_confirmations_spec.rb:19
F
2nd Try error in ./spec/system/users/reset_password_spec.rb:10:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/reset_password_spec.rb:10
F
1st Try error in ./spec/system/users/login_spec.rb:28:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/login_spec.rb:28
F
1st Try error in ./spec/system/users/email_confirmations_spec.rb:25:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/email_confirmations_spec.rb:25

1st Try error in ./spec/system/users/reset_password_spec.rb:32:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/reset_password_spec.rb:32

2nd Try error in ./spec/system/users/email_confirmations_spec.rb:25:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/email_confirmations_spec.rb:25

2nd Try error in ./spec/system/users/login_spec.rb:28:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/login_spec.rb:28
F
2nd Try error in ./spec/system/users/reset_password_spec.rb:32:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/reset_password_spec.rb:32
F
1st Try error in ./spec/system/users/email_confirmations_spec.rb:48:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/email_confirmations_spec.rb:48
F

Failures:

  1) InternalApi::V1::GenerateInvoice#index when user is an admin when no params are passed returns all line_item_entries
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) InternalApi::V1::GenerateInvoice#index when user is an admin when only selected entries param is passed returns no entries
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) InternalApi::V1::GenerateInvoice#index when user is an admin when user search with date filter returns new line with filter
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  4) InternalApi::V1::GenerateInvoice#index when user is an admin when user search with team member filter returns new line with team member filter
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  5) InternalApi::V1::GenerateInvoice#index when user is an admin when user search with search term returns new line with search term having first name
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  6) InternalApi::V1::GenerateInvoice#index when user is an admin when user search with empty search term returns all entries
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  7) InternalApi::V1::GenerateInvoice#index when user is an admin when user search with multiple filters at once returns all expected entries
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  8) InternalApi::V1::GenerateInvoice#index when user is an admin when the timesheet entry is already added to another draft invoice returns empty new_line_item_entries result
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:49:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  9) InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the 200 http response
     Failure/Error:
       json.clients clients do |client|
         json.name client[:name]
         json.logo client[:logo]
         json.invoices client[:invoices] do |invoice|
           json.client_name client[:name]
           json.invoice_no invoice.invoice_number
           json.issue_date invoice.formatted_issue_date
           json.due_date invoice.formatted_due_date
           json.amount invoice.amount
           json.status invoice.status

     ActionView::Template::Error:
       undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
     # ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'
     # ./app/controllers/internal_api/v1/reports/outstanding_overdue_invoices_controller.rb:10:in 'InternalApi::V1::Reports::OutstandingOverdueInvoicesController#index'
     # ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:93:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # NameError:
     #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
     #   ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'

  10) InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the clients data in alaphabetical order with invoices details
      Failure/Error:
        json.clients clients do |client|
          json.name client[:name]
          json.logo client[:logo]
          json.invoices client[:invoices] do |invoice|
            json.client_name client[:name]
            json.invoice_no invoice.invoice_number
            json.issue_date invoice.formatted_issue_date
            json.due_date invoice.formatted_due_date
            json.amount invoice.amount
            json.status invoice.status

      ActionView::Template::Error:
        undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      # ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'
      # ./app/controllers/internal_api/v1/reports/outstanding_overdue_invoices_controller.rb:10:in 'InternalApi::V1::Reports::OutstandingOverdueInvoicesController#index'
      # ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:93:in 'block (4 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NameError:
      #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      #   ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'

  11) InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the correct invoices for each client
      Failure/Error:
        json.clients clients do |client|
          json.name client[:name]
          json.logo client[:logo]
          json.invoices client[:invoices] do |invoice|
            json.client_name client[:name]
            json.invoice_no invoice.invoice_number
            json.issue_date invoice.formatted_issue_date
            json.due_date invoice.formatted_due_date
            json.amount invoice.amount
            json.status invoice.status

      ActionView::Template::Error:
        undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      # ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'
      # ./app/controllers/internal_api/v1/reports/outstanding_overdue_invoices_controller.rb:10:in 'InternalApi::V1::Reports::OutstandingOverdueInvoicesController#index'
      # ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:93:in 'block (4 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NameError:
      #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      #   ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'

  12) InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the base currency
      Failure/Error:
        json.clients clients do |client|
          json.name client[:name]
          json.logo client[:logo]
          json.invoices client[:invoices] do |invoice|
            json.client_name client[:name]
            json.invoice_no invoice.invoice_number
            json.issue_date invoice.formatted_issue_date
            json.due_date invoice.formatted_due_date
            json.amount invoice.amount
            json.status invoice.status

      ActionView::Template::Error:
        undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      # ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'
      # ./app/controllers/internal_api/v1/reports/outstanding_overdue_invoices_controller.rb:10:in 'InternalApi::V1::Reports::OutstandingOverdueInvoicesController#index'
      # ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:93:in 'block (4 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NameError:
      #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      #   ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'

  13) InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the summary of all clients invoices
      Failure/Error:
        json.clients clients do |client|
          json.name client[:name]
          json.logo client[:logo]
          json.invoices client[:invoices] do |invoice|
            json.client_name client[:name]
            json.invoice_no invoice.invoice_number
            json.issue_date invoice.formatted_issue_date
            json.due_date invoice.formatted_due_date
            json.amount invoice.amount
            json.status invoice.status

      ActionView::Template::Error:
        undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      # ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'
      # ./app/controllers/internal_api/v1/reports/outstanding_overdue_invoices_controller.rb:10:in 'InternalApi::V1::Reports::OutstandingOverdueInvoicesController#index'
      # ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:93:in 'block (4 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NameError:
      #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      #   ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'

  14) InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is a book keeper is permitted to view outstanding and overdue invoices report
      Failure/Error:
        json.clients clients do |client|
          json.name client[:name]
          json.logo client[:logo]
          json.invoices client[:invoices] do |invoice|
            json.client_name client[:name]
            json.invoice_no invoice.invoice_number
            json.issue_date invoice.formatted_issue_date
            json.due_date invoice.formatted_due_date
            json.amount invoice.amount
            json.status invoice.status

      ActionView::Template::Error:
        undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      # ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'
      # ./app/controllers/internal_api/v1/reports/outstanding_overdue_invoices_controller.rb:10:in 'InternalApi::V1::Reports::OutstandingOverdueInvoicesController#index'
      # ./spec/support/helpers/request_parser.rb:6:in 'Object#send_request'
      # ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:159:in 'block (3 levels) in <top (required)>'
      # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
      # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NameError:
      #   undefined local variable or method 'clients' for an instance of #<Class:0x000000013f278a40>
      #   ./app/views/internal_api/v1/reports/outstanding_overdue_invoices/index.json.jbuilder:7:in '_app_views_internal_api_v__reports_outstanding_overdue_invoices_index_json_jbuilder___2239733793528260809_57808'

  15) Delete client when deleting a client delete the client successfully
      Got 0 failures and 2 other errors:

      15.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/clients/delete_spec.rb:13:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      15.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  16) Edit employment details when editing employment details edit the current employment details successfully
      Got 0 failures and 2 other errors:

      16.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/employment_details/edit_spec.rb:17:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      16.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  17) Edit employment details when editing employment details edit the previous employment details successfully
      Got 0 failures and 2 other errors:

      17.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/employment_details/edit_spec.rb:17:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      17.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  18) Send Invoice when logged-in user is Admin is able to send invoice from Invoices List page even when no payment gateway is connected
      Got 0 failures and 2 other errors:
      Shared Example Group: "Send Invoice" called from ./spec/system/invoices/send_invoice_spec.rb:29

      18.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/invoices/send_invoice_spec.rb:26:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      18.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  19) Send Invoice when logged-in user is Admin is able to send invoice from Edit Invoice page even when no payment gateway is connected
      Got 0 failures and 2 other errors:
      Shared Example Group: "Send Invoice" called from ./spec/system/invoices/send_invoice_spec.rb:29

      19.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/invoices/send_invoice_spec.rb:26:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      19.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  20) Send Invoice when logged-in user is Owner is able to send invoice from Invoices List page even when no payment gateway is connected
      Got 0 failures and 2 other errors:
      Shared Example Group: "Send Invoice" called from ./spec/system/invoices/send_invoice_spec.rb:37

      20.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/invoices/send_invoice_spec.rb:34:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      20.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  21) Send Invoice when logged-in user is Owner is able to send invoice from Edit Invoice page even when no payment gateway is connected
      Got 0 failures and 2 other errors:
      Shared Example Group: "Send Invoice" called from ./spec/system/invoices/send_invoice_spec.rb:37

      21.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/invoices/send_invoice_spec.rb:34:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      21.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  22) Send Invoice when logged-in user is Employee is not able to see invoices option
      Got 0 failures and 2 other errors:

      22.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/invoices/send_invoice_spec.rb:42:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      22.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  23) Add team member to project when adding a project member for a project can add project member to a project
      Got 0 failures and 2 other errors:

      23.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/add_team_member_spec.rb:16:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      23.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  24) Add team member to project when project member is already added to a project can remove member from a project
      Got 0 failures and 2 other errors:

      24.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/add_team_member_spec.rb:44:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      24.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  25) Add team member to project when project member is already added to a project can edit the rate for a project member
      Got 0 failures and 2 other errors:

      25.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/add_team_member_spec.rb:44:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      25.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  26) Delete Project when user is an admin delete the project successfully
      Got 0 failures and 2 other errors:

      26.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/delete_spec.rb:15:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      26.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  27) Edit Project when user is an admin updates the project successfully
      Got 0 failures and 2 other errors:

      27.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/edit_spec.rb:15:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      27.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  28) Reset Password when visits reset password page allows user to reset password
      Got 0 failures and 2 other errors:

      28.1) Failure/Error: visit edit_user_password_path(reset_password_token: token)

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/reset_password_spec.rb:18:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/reset_password_spec.rb:11:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      28.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  29) Reset Password when the token is invalid displays an error message when the token is invalid
      Got 0 failures and 2 other errors:

      29.1) Failure/Error: visit edit_user_password_path(reset_password_token: "invalid_token")

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/reset_password_spec.rb:34:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/reset_password_spec.rb:33:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      29.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 29.24 seconds (files took 13.98 seconds to load)
142 examples, 29 failures

Failed examples:

rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:53 # InternalApi::V1::GenerateInvoice#index when user is an admin when no params are passed returns all line_item_entries
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:63 # InternalApi::V1::GenerateInvoice#index when user is an admin when only selected entries param is passed returns no entries
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:74 # InternalApi::V1::GenerateInvoice#index when user is an admin when user search with date filter returns new line with filter
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:86 # InternalApi::V1::GenerateInvoice#index when user is an admin when user search with team member filter returns new line with team member filter
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:97 # InternalApi::V1::GenerateInvoice#index when user is an admin when user search with search term returns new line with search term having first name
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:107 # InternalApi::V1::GenerateInvoice#index when user is an admin when user search with empty search term returns all entries
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:118 # InternalApi::V1::GenerateInvoice#index when user is an admin when user search with multiple filters at once returns all expected entries
rspec ./spec/requests/internal_api/v1/generate_invoice/index_spec.rb:129 # InternalApi::V1::GenerateInvoice#index when user is an admin when the timesheet entry is already added to another draft invoice returns empty new_line_item_entries result
rspec ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:96 # InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the 200 http response
rspec ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:100 # InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the clients data in alaphabetical order with invoices details
rspec ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:110 # InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the correct invoices for each client
rspec ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:125 # InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the base currency
rspec ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:129 # InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is an admin when outstanding and overdue invoices reports page's request is made returns the summary of all clients invoices
rspec ./spec/requests/internal_api/v1/reports/outstanding_overdue_invoices/index_spec.rb:162 # InternalApi::V1::Reports::OutstandingOverdueInvoicesController::#index when user is a book keeper is permitted to view outstanding and overdue invoices report
rspec ./spec/system/clients/delete_spec.rb:17 # Delete client when deleting a client delete the client successfully
rspec ./spec/system/employment_details/edit_spec.rb:21 # Edit employment details when editing employment details edit the current employment details successfully
rspec ./spec/system/employment_details/edit_spec.rb:36 # Edit employment details when editing employment details edit the previous employment details successfully
rspec './spec/system/invoices/send_invoice_spec.rb[1:1:1]' # Send Invoice when logged-in user is Admin is able to send invoice from Invoices List page even when no payment gateway is connected
rspec './spec/system/invoices/send_invoice_spec.rb[1:1:2]' # Send Invoice when logged-in user is Admin is able to send invoice from Edit Invoice page even when no payment gateway is connected
rspec './spec/system/invoices/send_invoice_spec.rb[1:2:1]' # Send Invoice when logged-in user is Owner is able to send invoice from Invoices List page even when no payment gateway is connected
rspec './spec/system/invoices/send_invoice_spec.rb[1:2:2]' # Send Invoice when logged-in user is Owner is able to send invoice from Edit Invoice page even when no payment gateway is connected
rspec ./spec/system/invoices/send_invoice_spec.rb:45 # Send Invoice when logged-in user is Employee is not able to see invoices option
rspec ./spec/system/projects/add_team_member_spec.rb:19 # Add team member to project when adding a project member for a project can add project member to a project
rspec ./spec/system/projects/add_team_member_spec.rb:47 # Add team member to project when project member is already added to a project can remove member from a project
rspec ./spec/system/projects/add_team_member_spec.rb:62 # Add team member to project when project member is already added to a project can edit the rate for a project member
rspec ./spec/system/projects/delete_spec.rb:18 # Delete Project when user is an admin delete the project successfully
rspec ./spec/system/projects/edit_spec.rb:18 # Edit Project when user is an admin updates the project successfully
rspec ./spec/system/users/reset_password_spec.rb:10 # Reset Password when visits reset password page allows user to reset password
rspec ./spec/system/users/reset_password_spec.rb:32 # Reset Password when the token is invalid displays an error message when the token is invalid


1st Try error in ./spec/system/users/login_spec.rb:42:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/login_spec.rb:42

2nd Try error in ./spec/system/users/email_confirmations_spec.rb:48:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/email_confirmations_spec.rb:48

2nd Try error in ./spec/system/users/login_spec.rb:42:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/login_spec.rb:42
F
1st Try error in ./spec/system/users/email_confirmations_spec.rb:54:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/email_confirmations_spec.rb:54
F

Failures:

  1) InternalApi::V1::Invoices#index when user is a book keeper search query returns invoices when query partially matches invoice number
     Failure/Error:
       expect(
         json_response["invoices"].pluck("id")
       ).to match_array(
         expected_invoices.pluck("id")
       )

       expected collection contained:  [145]
       actual collection contained:    [145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
       the extra elements were:        [146, 147, 148, 149, 150, 151, 152, 153, 154]
     # ./spec/requests/internal_api/v1/invoices/index_spec.rb:150:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) InternalApi::V1::Invoices#index when user is an admin from_to with date_range returns invoices with in the custom date range
     Failure/Error:
       expect(
         json_response["invoices"].pluck("id")
       ).to match_array(
         expected_invoices.pluck("id")
       )

       expected collection contained:  [235, 236, 238, 241, 242, 244]
       actual collection contained:    [235, 236, 237, 238, 239, 240, 241, 242, 243, 244]
       the extra elements were:        [237, 239, 240, 243]
     # ./spec/requests/internal_api/v1/invoices/index_spec.rb:224:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) InternalApi::V1::Invoices#index when user is an admin summary of invoices returns correct summary
     Failure/Error: expect(json_response["summary"]).to eq(JSON.parse(expected_data.to_json))

       expected: {"currency" => "YER", "draftAmount" => "681197.95", "outstandingAmount" => 0, "overdueAmount" => 0}
            got: {"currency" => "YER", "draftAmount" => "681197.95", "outstandingAmount" => "0.0", "overdueAmount" => "0.0", "paidAmount" => "0.0"}

       (compared using ==)

       Diff:
       @@ -1,4 +1,5 @@
        "currency" => "YER",
        "draftAmount" => "681197.95",
       -"outstandingAmount" => 0,
       -"overdueAmount" => 0,
       +"outstandingAmount" => "0.0",
       +"overdueAmount" => "0.0",
       +"paidAmount" => "0.0",
     # ./spec/requests/internal_api/v1/invoices/index_spec.rb:284:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  4) Payments index page when user is an admin when tries to fetch payments list returns the list of payments
     Got 0 failures and 2 other errors:

     4.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/payments/index_spec.rb:18:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     4.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  5) Team Member when user as an admin with less than ten team members cannot see the pagination
     Got 0 failures and 2 other errors:

     5.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/teams/index_spec.rb:17:in 'block (4 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     5.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  6) Team Member when user as an admin with more than ten members can view pagination
     Got 0 failures and 2 other errors:

     6.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/teams/index_spec.rb:39:in 'block (4 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     6.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  7) Team Member when user as an admin with more than ten members can paginate to the next page
     Got 0 failures and 2 other errors:

     7.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/teams/index_spec.rb:39:in 'block (4 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     7.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  8) Team Member when user as an admin with more than ten members displays ten users by default
     Got 0 failures and 2 other errors:

     8.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/teams/index_spec.rb:39:in 'block (4 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     8.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  9) Team Member when user as an admin with more than ten members can change number of users to show
     Got 0 failures and 2 other errors:

     9.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/teams/index_spec.rb:39:in 'block (4 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     9.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  10) Time Tracking - week view when user is admin can view other users entry
      Got 0 failures and 2 other errors:

      10.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/week_view_spec.rb:18:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      10.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  11) Time Tracking - week view when user is admin behaves like Time tracking - week view can view the time sheet entry
      Got 0 failures and 2 other errors:
      Shared Example Group: "Time tracking - week view" called from ./spec/system/time_tracking/week_view_spec.rb:12

      11.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/shared_examples/time_tracking/week_view.rb:15:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      11.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  12) Time Tracking - week view when user is admin behaves like Time tracking - week view can add time entry
      Got 0 failures and 2 other errors:
      Shared Example Group: "Time tracking - week view" called from ./spec/system/time_tracking/week_view_spec.rb:12

      12.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/shared_examples/time_tracking/week_view.rb:15:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      12.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  13) Time Tracking - week view when user is admin behaves like Time tracking - week view can edit time entry
      Got 0 failures and 2 other errors:
      Shared Example Group: "Time tracking - week view" called from ./spec/system/time_tracking/week_view_spec.rb:12

      13.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/shared_examples/time_tracking/week_view.rb:15:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      13.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  14) Time Tracking - week view when user is employee behaves like Time tracking - week view can view the time sheet entry
      Got 0 failures and 2 other errors:
      Shared Example Group: "Time tracking - week view" called from ./spec/system/time_tracking/week_view_spec.rb:36

      14.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/shared_examples/time_tracking/week_view.rb:21:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      14.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  15) Time Tracking - week view when user is employee behaves like Time tracking - week view can add time entry
      Got 0 failures and 2 other errors:
      Shared Example Group: "Time tracking - week view" called from ./spec/system/time_tracking/week_view_spec.rb:36

      15.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/shared_examples/time_tracking/week_view.rb:21:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      15.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  16) Time Tracking - week view when user is employee behaves like Time tracking - week view can edit time entry
      Got 0 failures and 2 other errors:
      Shared Example Group: "Time tracking - week view" called from ./spec/system/time_tracking/week_view_spec.rb:36

      16.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/shared_examples/time_tracking/week_view.rb:21:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      16.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  17) Sign-in when user is an admin, owner, employee allows a user to sign in with valid credentials
      Got 0 failures and 2 other errors:

      17.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/login_spec.rb:17:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/login_spec.rb:16:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      17.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  18) Sign-in when user is an admin, owner, employee displays an error message with invalid credentials
      Got 0 failures and 2 other errors:

      18.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/login_spec.rb:30:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/login_spec.rb:29:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      18.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  19) Sign-in when user is an admin, owner, employee displays an error message if the user's account is unconfirmed
      Got 0 failures and 2 other errors:

      19.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/login_spec.rb:46:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/login_spec.rb:45:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      19.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 30 seconds (files took 13.93 seconds to load)
156 examples, 19 failures

Failed examples:

rspec ./spec/requests/internal_api/v1/invoices/index_spec.rb:139 # InternalApi::V1::Invoices#index when user is a book keeper search query returns invoices when query partially matches invoice number
rspec ./spec/requests/internal_api/v1/invoices/index_spec.rb:213 # InternalApi::V1::Invoices#index when user is an admin from_to with date_range returns invoices with in the custom date range
rspec ./spec/requests/internal_api/v1/invoices/index_spec.rb:276 # InternalApi::V1::Invoices#index when user is an admin summary of invoices returns correct summary
rspec ./spec/system/payments/index_spec.rb:22 # Payments index page when user is an admin when tries to fetch payments list returns the list of payments
rspec ./spec/system/teams/index_spec.rb:20 # Team Member when user as an admin with less than ten team members cannot see the pagination
rspec ./spec/system/teams/index_spec.rb:42 # Team Member when user as an admin with more than ten members can view pagination
rspec ./spec/system/teams/index_spec.rb:54 # Team Member when user as an admin with more than ten members can paginate to the next page
rspec ./spec/system/teams/index_spec.rb:69 # Team Member when user as an admin with more than ten members displays ten users by default
rspec ./spec/system/teams/index_spec.rb:80 # Team Member when user as an admin with more than ten members can change number of users to show
rspec ./spec/system/time_tracking/week_view_spec.rb:14 # Time Tracking - week view when user is admin can view other users entry
rspec './spec/system/time_tracking/week_view_spec.rb[1:1:1:1]' # Time Tracking - week view when user is admin behaves like Time tracking - week view can view the time sheet entry
rspec './spec/system/time_tracking/week_view_spec.rb[1:1:1:2]' # Time Tracking - week view when user is admin behaves like Time tracking - week view can add time entry
rspec './spec/system/time_tracking/week_view_spec.rb[1:1:1:3]' # Time Tracking - week view when user is admin behaves like Time tracking - week view can edit time entry
rspec './spec/system/time_tracking/week_view_spec.rb[1:2:1:1]' # Time Tracking - week view when user is employee behaves like Time tracking - week view can view the time sheet entry
rspec './spec/system/time_tracking/week_view_spec.rb[1:2:1:2]' # Time Tracking - week view when user is employee behaves like Time tracking - week view can add time entry
rspec './spec/system/time_tracking/week_view_spec.rb[1:2:1:3]' # Time Tracking - week view when user is employee behaves like Time tracking - week view can edit time entry
rspec ./spec/system/users/login_spec.rb:15 # Sign-in when user is an admin, owner, employee allows a user to sign in with valid credentials
rspec ./spec/system/users/login_spec.rb:28 # Sign-in when user is an admin, owner, employee displays an error message with invalid credentials
rspec ./spec/system/users/login_spec.rb:42 # Sign-in when user is an admin, owner, employee displays an error message if the user's account is unconfirmed


2nd Try error in ./spec/system/users/email_confirmations_spec.rb:54:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/email_confirmations_spec.rb:54
F
1st Try error in ./spec/system/users/email_confirmations_spec.rb:64:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/email_confirmations_spec.rb:64

2nd Try error in ./spec/system/users/email_confirmations_spec.rb:64:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/email_confirmations_spec.rb:64
F

Failures:

  1) FileUploader#delete_after check if DeleteActiveStorageBlobJob job is queued
     Failure/Error: expect(DeleteActiveStorageBlobJob).to have_been_enqueued

     StandardError:
       To use ActiveJob matchers set `ActiveJob::Base.queue_adapter = :test`
     # ./spec/lib/file_uploader_spec.rb:45:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) Reports::TimeEntries::DownloadService#process Fetches all the users data
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/services/reports/time_entries/download_service_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) Reports::TimeEntries::DownloadService#process generates CSV report
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/services/reports/time_entries/download_service_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  4) Reports::TimeEntries::DownloadService#process generates a PDF report using Pdf::HtmlGenerator
     Failure/Error: TimesheetEntry.search_index.refresh

     NoMethodError:
       undefined method 'search_index' for class TimesheetEntry
     # ./spec/services/reports/time_entries/download_service_spec.rb:20:in 'block (2 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  5) Due invoice payment reminder can view invoice number on payment reminder modal
     Got 0 failures and 2 other errors:

     5.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/due_invoice_payment_reminder_spec.rb:16:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     5.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  6) Due invoice payment reminder can view client email and subject on email preview
     Got 0 failures and 2 other errors:

     6.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/due_invoice_payment_reminder_spec.rb:16:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     6.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  7) Due invoice payment reminder can send payment reminder to client
     Got 0 failures and 2 other errors:

     7.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/clients/due_invoice_payment_reminder_spec.rb:16:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     7.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  8) Employment index page when user is an admin returns the employment details
     Got 0 failures and 2 other errors:

     8.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/employment_details/index_spec.rb:16:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     8.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  9) Generate Invoice when logged-in user is Admin is able to view generate invoice page elements
     Got 0 failures and 2 other errors:
     Shared Example Group: "Generate Invoice" called from ./spec/system/invoices/generate_invoice_spec.rb:41

     9.1) Failure/Error:
            create(
              :timesheet_entry,
              user: employee,
              project:,
              work_date: Time.now,
              duration: 600,
              note: "Test note",
              bill_status: :unbilled
            )

          ActiveRecord::RecordInvalid:
            Validation failed: You can't create an unbilled entry for non-billable projects
          # ./spec/system/invoices/generate_invoice_spec.rb:25:in 'block (2 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     9.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  10) Generate Invoice when logged-in user is Admin is able to generates Invoice successfully for an employee of his organisation
      Got 0 failures and 2 other errors:
      Shared Example Group: "Generate Invoice" called from ./spec/system/invoices/generate_invoice_spec.rb:41

      10.1) Failure/Error:
              create(
                :timesheet_entry,
                user: employee,
                project:,
                work_date: Time.now,
                duration: 600,
                note: "Test note",
                bill_status: :unbilled
              )

            ActiveRecord::RecordInvalid:
              Validation failed: You can't create an unbilled entry for non-billable projects
            # ./spec/system/invoices/generate_invoice_spec.rb:25:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      10.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  11) Generate Invoice when logged-in user is an Owner is able to view generate invoice page elements
      Got 0 failures and 2 other errors:
      Shared Example Group: "Generate Invoice" called from ./spec/system/invoices/generate_invoice_spec.rb:49

      11.1) Failure/Error:
              create(
                :timesheet_entry,
                user: employee,
                project:,
                work_date: Time.now,
                duration: 600,
                note: "Test note",
                bill_status: :unbilled
              )

            ActiveRecord::RecordInvalid:
              Validation failed: You can't create an unbilled entry for non-billable projects
            # ./spec/system/invoices/generate_invoice_spec.rb:25:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      11.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  12) Generate Invoice when logged-in user is an Owner is able to generates Invoice successfully for an employee of his organisation
      Got 0 failures and 2 other errors:
      Shared Example Group: "Generate Invoice" called from ./spec/system/invoices/generate_invoice_spec.rb:49

      12.1) Failure/Error:
              create(
                :timesheet_entry,
                user: employee,
                project:,
                work_date: Time.now,
                duration: 600,
                note: "Test note",
                bill_status: :unbilled
              )

            ActiveRecord::RecordInvalid:
              Validation failed: You can't create an unbilled entry for non-billable projects
            # ./spec/system/invoices/generate_invoice_spec.rb:25:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      12.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  13) Generate Invoice when logged-in user is an Employee is not able to see invoices option
      Got 0 failures and 2 other errors:

      13.1) Failure/Error:
              create(
                :timesheet_entry,
                user: employee,
                project:,
                work_date: Time.now,
                duration: 600,
                note: "Test note",
                bill_status: :unbilled
              )

            ActiveRecord::RecordInvalid:
              Validation failed: You can't create an unbilled entry for non-billable projects
            # ./spec/system/invoices/generate_invoice_spec.rb:25:in 'block (2 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      13.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  14) Email confirmations when unconfirmed user logs in renders email confirmation page
      Got 0 failures and 2 other errors:

      14.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/email_confirmations_spec.rb:12:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/email_confirmations_spec.rb:11:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      14.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  15) Email confirmations when unconfirmed user logs in resends confirmation mail if user clicks on resend
      Got 0 failures and 2 other errors:

      15.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/email_confirmations_spec.rb:12:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/email_confirmations_spec.rb:11:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      15.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  16) Email confirmations when new user signup renders email confirmation page
      Got 0 failures and 2 other errors:

      16.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/email_confirmations_spec.rb:35:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/email_confirmations_spec.rb:34:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      16.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  17) Email confirmations when new user signup resends confirmation mail if user clicks on resend
      Got 0 failures and 2 other errors:

      17.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/email_confirmations_spec.rb:35:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/email_confirmations_spec.rb:34:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      17.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  18) Email confirmations when confirmed user visits email confirmation page throws error
      Got 0 failures and 2 other errors:

      18.1) Failure/Error: visit "/email_confirmation?email=#{user.email}"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/email_confirmations_spec.rb:66:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/email_confirmations_spec.rb:65:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      18.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 30.69 seconds (files took 14.11 seconds to load)
108 examples, 18 failures

Failed examples:

rspec ./spec/lib/file_uploader_spec.rb:44 # FileUploader#delete_after check if DeleteActiveStorageBlobJob job is queued
rspec ./spec/services/reports/time_entries/download_service_spec.rb:32 # Reports::TimeEntries::DownloadService#process Fetches all the users data
rspec ./spec/services/reports/time_entries/download_service_spec.rb:39 # Reports::TimeEntries::DownloadService#process generates CSV report
rspec ./spec/services/reports/time_entries/download_service_spec.rb:44 # Reports::TimeEntries::DownloadService#process generates a PDF report using Pdf::HtmlGenerator
rspec ./spec/system/clients/due_invoice_payment_reminder_spec.rb:19 # Due invoice payment reminder can view invoice number on payment reminder modal
rspec ./spec/system/clients/due_invoice_payment_reminder_spec.rb:32 # Due invoice payment reminder can view client email and subject on email preview
rspec ./spec/system/clients/due_invoice_payment_reminder_spec.rb:46 # Due invoice payment reminder can send payment reminder to client
rspec ./spec/system/employment_details/index_spec.rb:19 # Employment index page when user is an admin returns the employment details
rspec './spec/system/invoices/generate_invoice_spec.rb[1:1:1]' # Generate Invoice when logged-in user is Admin is able to view generate invoice page elements
rspec './spec/system/invoices/generate_invoice_spec.rb[1:1:2]' # Generate Invoice when logged-in user is Admin is able to generates Invoice successfully for an employee of his organisation
rspec './spec/system/invoices/generate_invoice_spec.rb[1:2:1]' # Generate Invoice when logged-in user is an Owner is able to view generate invoice page elements
rspec './spec/system/invoices/generate_invoice_spec.rb[1:2:2]' # Generate Invoice when logged-in user is an Owner is able to generates Invoice successfully for an employee of his organisation
rspec ./spec/system/invoices/generate_invoice_spec.rb:57 # Generate Invoice when logged-in user is an Employee is not able to see invoices option
rspec ./spec/system/users/email_confirmations_spec.rb:19 # Email confirmations when unconfirmed user logs in renders email confirmation page
rspec ./spec/system/users/email_confirmations_spec.rb:25 # Email confirmations when unconfirmed user logs in resends confirmation mail if user clicks on resend
rspec ./spec/system/users/email_confirmations_spec.rb:48 # Email confirmations when new user signup renders email confirmation page
rspec ./spec/system/users/email_confirmations_spec.rb:54 # Email confirmations when new user signup resends confirmation mail if user clicks on resend
rspec ./spec/system/users/email_confirmations_spec.rb:64 # Email confirmations when confirmed user visits email confirmation page throws error


1st Try error in ./spec/mailers/invoice_mailer_spec.rb:19:
Navigation timeout of 60000 ms exceeded

RSpec::Retry: 2nd try ./spec/mailers/invoice_mailer_spec.rb:19

1st Try error in ./spec/mailers/send_reminder_mailer_spec.rb:19:
Navigation timeout of 60000 ms exceeded

RSpec::Retry: 2nd try ./spec/mailers/send_reminder_mailer_spec.rb:19
.....................
1st Try error in ./spec/models/user_search_spec.rb:13:
expected #<ActiveRecord::Relation [#<User id: 1, first_name: "John", last_name: "Doe", email: [FILTERED], crea...}, phone: "+31 182.037.7604", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]> not to include #<User id: 3, first_name: "Bob", last_name: "Johnson", email: [FILTERED], created_at: "2025-08-10 14:...""}, phone: "+31 182.037.7604", token: [FILTERED], calendar_enabled: true, calendar_connected: true>
Diff:
@@ -1,3 +1,2 @@
-[#<User id: 2, first_name: "Jane", last_name: "Smith", email: [FILTERED], created_at: "2025-08-10 14:55:49.809819000 +0000", updated_at: "2025-08-10 14:55:49.809819000 +0000", current_workspace_id: 6, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1999-07-31", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+84 (425) 956 2599", token: [FILTERED], calendar_enabled: true, calendar_connected: true>,
- #<User id: 3, first_name: "Bob", last_name: "Johnson", email: [FILTERED], created_at: "2025-08-10 14:55:49.822147000 +0000", updated_at: "2025-08-10 14:55:49.822147000 +0000", current_workspace_id: 7, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1997-04-05", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+31 182.037.7604", token: [FILTERED], calendar_enabled: true, calendar_connected: true>,
- #<User id: 4, first_name: "Alice", last_name: "Doe", email: [FILTERED], created_at: "2025-08-10 14:55:49.833273000 +0000", updated_at: "2025-08-10 14:55:49.833273000 +0000", current_workspace_id: 8, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1991-06-19", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+34 (328) 518-0335", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]
+[#<User id: 1, first_name: "John", last_name: "Doe", email: [FILTERED], created_at: "2025-08-10 14:55:49.795698000 +0000", updated_at: "2025-08-10 14:55:49.795698000 +0000", current_workspace_id: 5, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1993-12-15", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+30 (737) 608-0189", token: [FILTERED], calendar_enabled: true, calendar_connected: true>,
+ #<User id: 3, first_name: "Bob", last_name: "Johnson", email: [FILTERED], created_at: "2025-08-10 14:55:49.822147000 +0000", updated_at: "2025-08-10 14:55:49.822147000 +0000", current_workspace_id: 7, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1997-04-05", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+31 182.037.7604", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]


RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:13
.......
2nd Try error in ./spec/models/user_search_spec.rb:13:
expected #<ActiveRecord::Relation [#<User id: 5, first_name: "John", last_name: "Doe", email: [FILTERED], crea... phone: "+30 (219) 695-2777", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]> not to include #<User id: 7, first_name: "Bob", last_name: "Johnson", email: [FILTERED], created_at: "2025-08-10 14:...}, phone: "+30 (219) 695-2777", token: [FILTERED], calendar_enabled: true, calendar_connected: true>
Diff:
@@ -1,3 +1,2 @@
-[#<User id: 6, first_name: "Jane", last_name: "Smith", email: [FILTERED], created_at: "2025-08-10 14:55:49.878552000 +0000", updated_at: "2025-08-10 14:55:49.878552000 +0000", current_workspace_id: 10, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1998-07-14", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+1 648 748 1802", token: [FILTERED], calendar_enabled: true, calendar_connected: true>,
- #<User id: 7, first_name: "Bob", last_name: "Johnson", email: [FILTERED], created_at: "2025-08-10 14:55:49.889140000 +0000", updated_at: "2025-08-10 14:55:49.889140000 +0000", current_workspace_id: 11, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1995-06-21", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+30 (219) 695-2777", token: [FILTERED], calendar_enabled: true, calendar_connected: true>,
- #<User id: 8, first_name: "Alice", last_name: "Doe", email: [FILTERED], created_at: "2025-08-10 14:55:49.899560000 +0000", updated_at: "2025-08-10 14:55:49.899560000 +0000", current_workspace_id: 12, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1994-09-01", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+20 6087758277", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]
+[#<User id: 5, first_name: "John", last_name: "Doe", email: [FILTERED], created_at: "2025-08-10 14:55:49.867220000 +0000", updated_at: "2025-08-10 14:55:49.867220000 +0000", current_workspace_id: 9, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1999-01-06", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+34 465.966.8002", token: [FILTERED], calendar_enabled: true, calendar_connected: true>,
+ #<User id: 7, first_name: "Bob", last_name: "Johnson", email: [FILTERED], created_at: "2025-08-10 14:55:49.889140000 +0000", updated_at: "2025-08-10 14:55:49.889140000 +0000", current_workspace_id: 11, discarded_at: nil, personal_email_id: [FILTERED], date_of_birth: "1995-06-21", social_accounts: {"github_url" => "", "linkedin_url" => ""}, phone: "+30 (219) 695-2777", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]

RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:13
...F......
1st Try error in ./spec/models/invoice_search_spec.rb:17:

expected: 1
     got: 4

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/invoice_search_spec.rb:17
.
2nd Try error in ./spec/models/invoice_search_spec.rb:17:

expected: 1
     got: 4

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/invoice_search_spec.rb:17
F.
1st Try error in ./spec/models/invoice_search_spec.rb:23:
expected #<ActiveRecord::Relation []> to include #<Invoice id: 16, issue_date: "2025-08-10", due_date: "2025-08-10", invoice_number: "INV-2024-001", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.8307538e5>, #<Invoice id: 17, issue_date: "2025-08-03", due_date: "2025-08-06", invoice_number: "INV-2024-002", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.5427427e5>, #<Invoice id: 18, issue_date: "2025-07-10", due_date: "2025-07-24", invoice_number: "INV-2024-003", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.6659336e5>, and #<Invoice id: 19, issue_date: "2025-06-10", due_date: "2025-07-09", invoice_number: "INV-2024-004", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.6596007e5>
Diff:
@@ -1,4 +1 @@
-[#<Invoice id: 16, issue_date: "2025-08-10", due_date: "2025-08-10", invoice_number: "INV-2024-001", reference: "266844", amount: 0.8307538e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "draft", client_id: 14, created_at: "2025-08-10 14:55:50.143346000 +0000", updated_at: "2025-08-10 14:55:50.143346000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 21, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.8307538e5>,
- #<Invoice id: 17, issue_date: "2025-08-03", due_date: "2025-08-06", invoice_number: "INV-2024-002", reference: "547406035708", amount: 0.5427427e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "sent", client_id: 14, created_at: "2025-08-10 14:55:50.146930000 +0000", updated_at: "2025-08-10 14:55:50.146930000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 21, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.5427427e5>,
- #<Invoice id: 18, issue_date: "2025-07-10", due_date: "2025-07-24", invoice_number: "INV-2024-003", reference: "214682756", amount: 0.6659336e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "paid", client_id: 15, created_at: "2025-08-10 14:55:50.159956000 +0000", updated_at: "2025-08-10 14:55:50.159956000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 21, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.6659336e5>,
- #<Invoice id: 19, issue_date: "2025-06-10", due_date: "2025-07-09", invoice_number: "INV-2024-004", reference: "063988091827", amount: 0.6596007e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "overdue", client_id: 15, created_at: "2025-08-10 14:55:50.162041000 +0000", updated_at: "2025-08-10 14:55:50.162041000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 21, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.6596007e5>]
+[]


RSpec::Retry: 2nd try ./spec/models/invoice_search_spec.rb:23

2nd Try error in ./spec/models/invoice_search_spec.rb:23:
expected #<ActiveRecord::Relation []> to include #<Invoice id: 20, issue_date: "2025-08-10", due_date: "2025-08-10", invoice_number: "INV-2024-001", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.3740333e5>, #<Invoice id: 21, issue_date: "2025-08-03", due_date: "2025-08-10", invoice_number: "INV-2024-002", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.4937712e5>, #<Invoice id: 22, issue_date: "2025-07-10", due_date: "2025-08-10", invoice_number: "INV-2024-003", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9724178e5>, and #<Invoice id: 23, issue_date: "2025-06-10", due_date: "2025-07-09", invoice_number: "INV-2024-004", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.3085211e5>
Diff:
@@ -1,4 +1 @@
-[#<Invoice id: 20, issue_date: "2025-08-10", due_date: "2025-08-10", invoice_number: "INV-2024-001", reference: "123288759324", amount: 0.3740333e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "draft", client_id: 16, created_at: "2025-08-10 14:55:50.182073000 +0000", updated_at: "2025-08-10 14:55:50.182073000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 22, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.3740333e5>,
- #<Invoice id: 21, issue_date: "2025-08-03", due_date: "2025-08-10", invoice_number: "INV-2024-002", reference: "1366", amount: 0.4937712e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "sent", client_id: 16, created_at: "2025-08-10 14:55:50.185205000 +0000", updated_at: "2025-08-10 14:55:50.185205000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 22, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.4937712e5>,
- #<Invoice id: 22, issue_date: "2025-07-10", due_date: "2025-08-10", invoice_number: "INV-2024-003", reference: "996647830", amount: 0.9724178e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "paid", client_id: 17, created_at: "2025-08-10 14:55:50.192975000 +0000", updated_at: "2025-08-10 14:55:50.192975000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 22, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9724178e5>,
- #<Invoice id: 23, issue_date: "2025-06-10", due_date: "2025-07-09", invoice_number: "INV-2024-004", reference: "939352805687", amount: 0.3085211e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "overdue", client_id: 17, created_at: "2025-08-10 14:55:50.195606000 +0000", updated_at: "2025-08-10 14:55:50.195606000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 22, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.3085211e5>]
+[]

RSpec::Retry: 3rd try ./spec/models/invoice_search_spec.rb:23
.F..
1st Try error in ./spec/models/invoice_search_spec.rb:33:
expected `#<ActiveRecord::Relation [#<Invoice id: 33, issue_date: "2025-08-03", due_date: "2025-08-09", invoice...nt_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9934571e5>]>.empty?` to be truthy, got false

RSpec::Retry: 2nd try ./spec/models/invoice_search_spec.rb:33
.........................
1st Try error in ./spec/models/invoice_search_spec.rb:150:

expected: 5
     got: 14

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/invoice_search_spec.rb:150

2nd Try error in ./spec/models/invoice_search_spec.rb:150:

expected: 5
     got: 14

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/invoice_search_spec.rb:150

1st Try error in ./spec/models/user_search_spec.rb:122:

expected: 1
     got: 2

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:122
F
2nd Try error in ./spec/models/user_search_spec.rb:122:

expected: 1
     got: 2

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:122

1st Try error in ./spec/models/invoice_search_spec.rb:155:

expected: 5
     got: 14

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/invoice_search_spec.rb:155

2nd Try error in ./spec/models/invoice_search_spec.rb:155:

expected: 5
     got: 14

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/invoice_search_spec.rb:155
FF
1st Try error in ./spec/models/invoice_search_spec.rb:166:
expected #<ActiveRecord::Relation []> to include #<Invoice id: 189, issue_date: "2025-07-10", due_date: "2025-08-06", invoice_number: "INV-2024-003", ...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.2302125e5>
Diff:
@@ -1 +1 @@
-[#<Invoice id: 189, issue_date: "2025-07-10", due_date: "2025-08-06", invoice_number: "INV-2024-003", reference: "916051953877", amount: 0.2302125e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "paid", client_id: 70, created_at: "2025-08-10 14:55:51.120397000 +0000", updated_at: "2025-08-10 14:55:51.120397000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 49, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.2302125e5>]
+[]


RSpec::Retry: 2nd try ./spec/models/invoice_search_spec.rb:166
.
2nd Try error in ./spec/models/invoice_search_spec.rb:166:
expected #<ActiveRecord::Relation []> to include #<Invoice id: 193, issue_date: "2025-07-10", due_date: "2025-07-15", invoice_number: "INV-2024-003", ...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9201952e5>
Diff:
@@ -1 +1 @@
-[#<Invoice id: 193, issue_date: "2025-07-10", due_date: "2025-07-15", invoice_number: "INV-2024-003", reference: "937266083248", amount: 0.9201952e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "paid", client_id: 72, created_at: "2025-08-10 14:55:51.148916000 +0000", updated_at: "2025-08-10 14:55:51.148916000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 50, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9201952e5>]
+[]

RSpec::Retry: 3rd try ./spec/models/invoice_search_spec.rb:166
F.......
1st Try error in ./spec/models/metric_spec.rb:33:

expected: #<Metric id: 1, trackable_type: "Client", trackable_id: 79, metric_type: "hours_logged", period: "wee...reated_at: "2025-08-10 14:55:51.283752000 +0000", updated_at: "2025-08-10 14:55:51.283752000 +0000">
     got: #<Metric id: 2, trackable_type: "Client", trackable_id: 79, metric_type: "hours_logged", period: "wee...reated_at: "2025-08-10 14:55:51.300204000 +0000", updated_at: "2025-08-10 14:55:51.300204000 +0000">

(compared using ==)

Diff:


@@ -1,17 +1,18 @@
-#<Metric:0x0000000133a1fca0
- id: 1,
+#<Metric:0x0000000133a1f020
+ id: 2,
  trackable_type: "Client",
  trackable_id: 79,
  metric_type: "hours_logged",
  period: "week",
- period_date: "2025-08-10",
- data: {"total_minutes" => 480},
+ period_date: "2025-08-04",
+ data:
+  {"total_minutes" => 0.0, "total_hours" => 0.0, "entry_count" => 0, "unique_users" => 0, "unique_projects" => 0, "by_project" => {}, "by_user" => {}, "by_date" => {}},
  value_sum: 0.0,
  value_count: 0,
  value_avg: 0.0,
  value_min: nil,
  value_max: nil,
  metadata: {},
- calculated_at: "2025-08-10 13:55:51.280438000 +0000",
- created_at: "2025-08-10 14:55:51.283752000 +0000",
- updated_at: "2025-08-10 14:55:51.283752000 +0000">
+ calculated_at: "2025-08-10 14:55:51.300010000 +0000",
+ created_at: "2025-08-10 14:55:51.300204000 +0000",
+ updated_at: "2025-08-10 14:55:51.300204000 +0000">


RSpec::Retry: 2nd try ./spec/models/metric_spec.rb:33

2nd Try error in ./spec/models/metric_spec.rb:33:

expected: #<Metric id: 3, trackable_type: "Client", trackable_id: 80, metric_type: "hours_logged", period: "wee...reated_at: "2025-08-10 14:55:51.322337000 +0000", updated_at: "2025-08-10 14:55:51.322337000 +0000">
     got: #<Metric id: 4, trackable_type: "Client", trackable_id: 80, metric_type: "hours_logged", period: "wee...reated_at: "2025-08-10 14:55:51.327997000 +0000", updated_at: "2025-08-10 14:55:51.327997000 +0000">

(compared using ==)

Diff:


@@ -1,17 +1,18 @@
-#<Metric:0x0000000133a185e0
- id: 3,
+#<Metric:0x0000000133a17be0
+ id: 4,
  trackable_type: "Client",
  trackable_id: 80,
  metric_type: "hours_logged",
  period: "week",
- period_date: "2025-08-10",
- data: {"total_minutes" => 480},
+ period_date: "2025-08-04",
+ data:
+  {"total_minutes" => 0.0, "total_hours" => 0.0, "entry_count" => 0, "unique_users" => 0, "unique_projects" => 0, "by_project" => {}, "by_user" => {}, "by_date" => {}},
  value_sum: 0.0,
  value_count: 0,
  value_avg: 0.0,
  value_min: nil,
  value_max: nil,
  metadata: {},
- calculated_at: "2025-08-10 13:55:51.321713000 +0000",
- created_at: "2025-08-10 14:55:51.322337000 +0000",
- updated_at: "2025-08-10 14:55:51.322337000 +0000">
+ calculated_at: "2025-08-10 14:55:51.327818000 +0000",
+ created_at: "2025-08-10 14:55:51.327997000 +0000",
+ updated_at: "2025-08-10 14:55:51.327997000 +0000">

RSpec::Retry: 3rd try ./spec/models/metric_spec.rb:33
F.
1st Try error in ./spec/models/user_search_spec.rb:153:

expected: 5
     got: 14

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:153
..
1st Try error in ./spec/models/metric_spec.rb:101:

expected: 2250
     got: "0.0"

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/metric_spec.rb:101

2nd Try error in ./spec/models/metric_spec.rb:101:

expected: 2250
     got: "0.0"

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/metric_spec.rb:101

2nd Try error in ./spec/models/user_search_spec.rb:153:

expected: 5
     got: 14

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:153
F
1st Try error in ./spec/models/metric_spec.rb:119:
expected `#<Metric id: nil, trackable_type: "Client", trackable_id: nil, metric_type: "hours_logged", period: "...etadata: {}, calculated_at: "2025-08-10 14:25:51.591551000 +0000", created_at: nil, updated_at: nil>.stale?` to be falsey, got true

RSpec::Retry: 2nd try ./spec/models/metric_spec.rb:119

2nd Try error in ./spec/models/metric_spec.rb:119:
expected `#<Metric id: nil, trackable_type: "Client", trackable_id: nil, metric_type: "hours_logged", period: "...etadata: {}, calculated_at: "2025-08-10 14:25:51.593411000 +0000", created_at: nil, updated_at: nil>.stale?` to be falsey, got true
RSpec::Retry: 3rd try ./spec/models/metric_spec.rb:119
F........F....
1st Try error in ./spec/models/user_search_spec.rb:159:

expected: 5
     got: 14

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:159
....
2nd Try error in ./spec/models/user_search_spec.rb:159:

expected: 5
     got: 14

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:159
...F....
1st Try error in ./spec/models/user_search_spec.rb:168:

expected: 4
     got: 0

(compared using ==)


RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:168
.....
2nd Try error in ./spec/models/user_search_spec.rb:168:

expected: 4
     got: 0

(compared using ==)

RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:168
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....F........./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/rspec-rails-7.1.1/lib/rspec/rails/matchers/have_http_status.rb:219: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
....
1st Try error in ./spec/models/user_search_spec.rb:211:
expected `#<ActiveRecord::Associations::HasManyThroughAssociation:0x00000001326dc080 @owner=#<User id: 259, fir...t: {}>, @association_ids=nil, @association_scope=nil, @skip_strict_loading=nil, @through_records={}>.loaded?` to be truthy, got false

RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:211
..
2nd Try error in ./spec/models/user_search_spec.rb:211:
expected `#<ActiveRecord::Associations::HasManyThroughAssociation:0x0000000134291870 @owner=#<User id: 263, fir...t: {}>, @association_ids=nil, @association_scope=nil, @skip_strict_loading=nil, @through_records={}>.loaded?` to be truthy, got false
RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:211
.F..
1st Try error in ./spec/models/user_search_spec.rb:219:
expected `#<ActiveRecord::Relation [#<User id: 271, first_name: "John", last_name: "Doe", email: [FILTERED], cr...""}, phone: "+33 2504739697", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]>.empty?` to be truthy, got false

RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:219
..
2nd Try error in ./spec/models/user_search_spec.rb:219:
expected `#<ActiveRecord::Relation [#<User id: 275, first_name: "John", last_name: "Doe", email: [FILTERED], cr...}, phone: "+49 374 443 0812", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]>.empty?` to be truthy, got false
RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:219
..F.
1st Try error in ./spec/models/user_search_spec.rb:229:
expected `#<ActiveRecord::Relation [#<User id: 283, first_name: "John", last_name: "Doe", email: [FILTERED], cr...}, phone: "+41 992-460-5120", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]>.empty?` to be truthy, got false

RSpec::Retry: 2nd try ./spec/models/user_search_spec.rb:229
..
2nd Try error in ./spec/models/user_search_spec.rb:229:
expected `#<ActiveRecord::Relation [#<User id: 287, first_name: "John", last_name: "Doe", email: [FILTERED], cr..."}, phone: "+7 372-146-1093", token: [FILTERED], calendar_enabled: true, calendar_connected: true>]>.empty?` to be truthy, got false
RSpec::Retry: 3rd try ./spec/models/user_search_spec.rb:229
.F.....E, [2025-08-10T20:25:53.780934 #96484] ERROR -- omniauth: (google_oauth2) Authentication failure! invalid_credentials encountered.
.E, [2025-08-10T20:25:53.799458 #96484] ERROR -- omniauth: (google_oauth2) Authentication failure! invalid_credentials encountered.
........................
1st Try error in ./spec/system/projects/create_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/create_spec.rb:18

2nd Try error in ./spec/system/projects/create_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/create_spec.rb:18
..F.....
1st Try error in ./spec/requests/home/index_spec.rb:12:
undefined method 'react_component' for an instance of #<Class:0x000000013389fdd0>

RSpec::Retry: 2nd try ./spec/requests/home/index_spec.rb:12

1st Try error in ./spec/system/projects/create_spec.rb:37:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/create_spec.rb:37

2nd Try error in ./spec/requests/home/index_spec.rb:12:
undefined method 'react_component' for an instance of #<Class:0x000000013389fdd0>
RSpec::Retry: 3rd try ./spec/requests/home/index_spec.rb:12
F...
2nd Try error in ./spec/system/projects/create_spec.rb:37:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/create_spec.rb:37
....F....
1st Try error in ./spec/system/projects/create_spec.rb:55:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/create_spec.rb:55
...
2nd Try error in ./spec/system/projects/create_spec.rb:55:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/create_spec.rb:55
....F....
1st Try error in ./spec/system/projects/create_spec.rb:78:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/create_spec.rb:78
.
2nd Try error in ./spec/system/projects/create_spec.rb:78:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/create_spec.rb:78
F
1st Try error in ./spec/system/projects/search_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/search_spec.rb:18

2nd Try error in ./spec/system/projects/search_spec.rb:18:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/search_spec.rb:18
F
1st Try error in ./spec/system/projects/search_spec.rb:29:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/projects/search_spec.rb:29

2nd Try error in ./spec/system/projects/search_spec.rb:29:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/projects/search_spec.rb:29
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:21:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:21

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:21:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:21
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:32:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:32

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:32:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:32
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:48:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:48

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:48:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:48
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:62:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:62

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:62:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:62
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:75:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:75

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:75:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:75
..F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:101:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:101

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:101:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:101
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:112:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:112

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:112:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:112
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:127:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:127

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:127:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:127
F
1st Try error in ./spec/system/time_tracking/day_view_spec.rb:142:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/time_tracking/day_view_spec.rb:142

2nd Try error in ./spec/system/time_tracking/day_view_spec.rb:142:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/time_tracking/day_view_spec.rb:142
F
1st Try error in ./spec/system/users/signup_spec.rb:10:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:10

2nd Try error in ./spec/system/users/signup_spec.rb:10:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:10
F
1st Try error in ./spec/system/users/signup_spec.rb:28:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:28

2nd Try error in ./spec/system/users/signup_spec.rb:28:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:28
F
1st Try error in ./spec/system/users/signup_spec.rb:46:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:46

2nd Try error in ./spec/system/users/signup_spec.rb:46:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:46
F
1st Try error in ./spec/system/users/signup_spec.rb:64:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:64

2nd Try error in ./spec/system/users/signup_spec.rb:64:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:64
F
1st Try error in ./spec/system/users/signup_spec.rb:91:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:91

2nd Try error in ./spec/system/users/signup_spec.rb:91:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:91
F
1st Try error in ./spec/system/users/signup_spec.rb:110:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:110

2nd Try error in ./spec/system/users/signup_spec.rb:110:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:110
F
1st Try error in ./spec/system/users/signup_spec.rb:127:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:127

2nd Try error in ./spec/system/users/signup_spec.rb:127:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:127
F
1st Try error in ./spec/system/users/signup_spec.rb:144:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:144

2nd Try error in ./spec/system/users/signup_spec.rb:144:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:144
F
1st Try error in ./spec/system/users/signup_spec.rb:161:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:161

2nd Try error in ./spec/system/users/signup_spec.rb:161:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:161
F.....
1st Try error in ./spec/system/users/signup_spec.rb:178:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:178
.....
2nd Try error in ./spec/system/users/signup_spec.rb:178:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:178
.
1st Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:23:
key not found: :name

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/team/index_spec.rb:23

2nd Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:23:
key not found: :name
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/team/index_spec.rb:23
F
1st Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:27:
key not found: :name

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/team/index_spec.rb:27
F
2nd Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:27:
key not found: :name
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/team/index_spec.rb:27
F
1st Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:37:
key not found: :name

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/team/index_spec.rb:37

2nd Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:37:
key not found: :name
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/team/index_spec.rb:37

1st Try error in ./spec/system/users/signup_spec.rb:195:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:195
F
1st Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:57:
key not found: :name

RSpec::Retry: 2nd try ./spec/requests/internal_api/v1/team/index_spec.rb:57

2nd Try error in ./spec/requests/internal_api/v1/team/index_spec.rb:57:
key not found: :name
RSpec::Retry: 3rd try ./spec/requests/internal_api/v1/team/index_spec.rb:57
F..
2nd Try error in ./spec/system/users/signup_spec.rb:195:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:195
........F......
1st Try error in ./spec/system/users/signup_spec.rb:212:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:212
......
2nd Try error in ./spec/system/users/signup_spec.rb:212:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:212
/Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
./Users/sward/.local/share/mise/installs/ruby/3.4.5/lib/ruby/gems/3.4.0/gems/actionpack-8.0.2/lib/action_controller/metal/rendering.rb:235: warning: Status code :unprocessable_content is deprecated and will be removed in a future version of Rack. Please use :unprocessable_content instead.
..F
1st Try error in ./spec/system/users/signup_spec.rb:229:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:229

2nd Try error in ./spec/system/users/signup_spec.rb:229:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:229
F
1st Try error in ./spec/system/users/signup_spec.rb:246:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil

RSpec::Retry: 2nd try ./spec/system/users/signup_spec.rb:246

2nd Try error in ./spec/system/users/signup_spec.rb:246:
undefined method 'needs_server?' for nil
undefined method 'needs_server?' for nil
RSpec::Retry: 3rd try ./spec/system/users/signup_spec.rb:246
F

Failures:

  1) Invoice search functionality Invoice.search basic search finds invoices by exact invoice number
     Failure/Error: expect(results.count).to eq(1)

       expected: 1
            got: 4

       (compared using ==)
     # ./spec/models/invoice_search_spec.rb:20:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  2) Invoice search functionality Invoice.search basic search finds invoices by partial invoice number
     Failure/Error: expect(results).to include(invoice1, invoice2, invoice3, invoice4)

       expected #<ActiveRecord::Relation []> to include #<Invoice id: 24, issue_date: "2025-08-10", due_date: "2025-08-10", invoice_number: "INV-2024-001", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9066089e5>, #<Invoice id: 25, issue_date: "2025-08-03", due_date: "2025-08-06", invoice_number: "INV-2024-002", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.8875327e5>, #<Invoice id: 26, issue_date: "2025-07-10", due_date: "2025-07-30", invoice_number: "INV-2024-003", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9125168e5>, and #<Invoice id: 27, issue_date: "2025-06-10", due_date: "2025-06-10", invoice_number: "INV-2024-004", r...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.1383258e5>
       Diff:
       @@ -1,4 +1 @@
       -[#<Invoice id: 24, issue_date: "2025-08-10", due_date: "2025-08-10", invoice_number: "INV-2024-001", reference: "2374", amount: 0.9066089e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "draft", client_id: 18, created_at: "2025-08-10 14:55:50.214515000 +0000", updated_at: "2025-08-10 14:55:50.214515000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 23, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9066089e5>,
       - #<Invoice id: 25, issue_date: "2025-08-03", due_date: "2025-08-06", invoice_number: "INV-2024-002", reference: "119", amount: 0.8875327e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "sent", client_id: 18, created_at: "2025-08-10 14:55:50.217365000 +0000", updated_at: "2025-08-10 14:55:50.217365000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 23, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.8875327e5>,
       - #<Invoice id: 26, issue_date: "2025-07-10", due_date: "2025-07-30", invoice_number: "INV-2024-003", reference: "916148547479", amount: 0.9125168e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "paid", client_id: 19, created_at: "2025-08-10 14:55:50.224122000 +0000", updated_at: "2025-08-10 14:55:50.224122000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 23, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9125168e5>,
       - #<Invoice id: 27, issue_date: "2025-06-10", due_date: "2025-06-10", invoice_number: "INV-2024-004", reference: "7084", amount: 0.1383258e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "overdue", client_id: 19, created_at: "2025-08-10 14:55:50.226417000 +0000", updated_at: "2025-08-10 14:55:50.226417000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 23, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.1383258e5>]
       +[]
     # ./spec/models/invoice_search_spec.rb:25:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  3) Invoice search functionality Invoice.search pagination limits results
     Failure/Error: expect(results.count).to eq(5)

       expected: 5
            got: 14

       (compared using ==)
     # ./spec/models/invoice_search_spec.rb:152:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  4) Invoice search functionality Invoice.search pagination paginates correctly
     Failure/Error: expect(page1.count).to eq(5)

       expected: 5
            got: 14

       (compared using ==)
     # ./spec/models/invoice_search_spec.rb:159:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  5) Invoice search functionality Invoice.search complex queries combines search term with status filter
     Failure/Error: expect(results).to include(invoice3)

       expected #<ActiveRecord::Relation []> to include #<Invoice id: 197, issue_date: "2025-07-10", due_date: "2025-07-25", invoice_number: "INV-2024-003", ...ient_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9788217e5>
       Diff:
       @@ -1 +1 @@
       -[#<Invoice id: 197, issue_date: "2025-07-10", due_date: "2025-07-25", invoice_number: "INV-2024-003", reference: "098925830227", amount: 0.9788217e5, outstanding_amount: 0.0, tax: 0.0, amount_paid: 0.0, amount_due: 0.0, discount: 0.0, status: "paid", client_id: 74, created_at: "2025-08-10 14:55:51.180782000 +0000", updated_at: "2025-08-10 14:55:51.180782000 +0000", external_view_key: [FILTERED], payment_infos: {}, company_id: 51, discarded_at: nil, sent_at: nil, payment_sent_at: nil, client_payment_sent_at: nil, stripe_enabled: true, currency: "USD", base_currency_amount: 0.9788217e5>]
       +[]
     # ./spec/models/invoice_search_spec.rb:168:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  6) Metric.fetch_or_calculate when metric exists and is fresh returns existing metric without recalculation
     Failure/Error: expect(result).to eq(metric)

       expected: #<Metric id: 5, trackable_type: "Client", trackable_id: 81, metric_type: "hours_logged", period: "wee...reated_at: "2025-08-10 14:55:51.343734000 +0000", updated_at: "2025-08-10 14:55:51.343734000 +0000">
            got: #<Metric id: 6, trackable_type: "Client", trackable_id: 81, metric_type: "hours_logged", period: "wee...reated_at: "2025-08-10 14:55:51.350015000 +0000", updated_at: "2025-08-10 14:55:51.350015000 +0000">

       (compared using ==)

       Diff:


       @@ -1,17 +1,18 @@
       -#<Metric:0x0000000133a10b60
       - id: 5,
       +#<Metric:0x0000000133a10020
       + id: 6,
         trackable_type: "Client",
         trackable_id: 81,
         metric_type: "hours_logged",
         period: "week",
       - period_date: "2025-08-10",
       - data: {"total_minutes" => 480},
       + period_date: "2025-08-04",
       + data:
       +  {"total_minutes" => 0.0, "total_hours" => 0.0, "entry_count" => 0, "unique_users" => 0, "unique_projects" => 0, "by_project" => {}, "by_user" => {}, "by_date" => {}},
         value_sum: 0.0,
         value_count: 0,
         value_avg: 0.0,
         value_min: nil,
         value_max: nil,
         metadata: {},
       - calculated_at: "2025-08-10 13:55:51.343412000 +0000",
       - created_at: "2025-08-10 14:55:51.343734000 +0000",
       - updated_at: "2025-08-10 14:55:51.343734000 +0000">
       + calculated_at: "2025-08-10 14:55:51.349872000 +0000",
       + created_at: "2025-08-10 14:55:51.350015000 +0000",
       + updated_at: "2025-08-10 14:55:51.350015000 +0000">
     # ./spec/models/metric_spec.rb:35:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  7) Metric#calculate! calculates client revenue metrics
     Failure/Error: expect(metric.data["total_revenue"]).to eq(2250)

       expected: 2250
            got: "0.0"

       (compared using ==)
     # ./spec/models/metric_spec.rb:104:in 'block (3 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  8) Metric#stale? when calculated recently returns false
     Failure/Error: expect(metric).not_to be_stale
       expected `#<Metric id: nil, trackable_type: "Client", trackable_id: nil, metric_type: "hours_logged", period: "...etadata: {}, calculated_at: "2025-08-10 14:25:51.594683000 +0000", created_at: nil, updated_at: nil>.stale?` to be falsey, got true
     # ./spec/models/metric_spec.rb:120:in 'block (4 levels) in <top (required)>'
     # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
     # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  9) Creating Project when user is an admin when creating a billable project creates a billable project successfully
     Got 0 failures and 2 other errors:

     9.1) Failure/Error: visit "/login"

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
          # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
          # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
          # ./spec/system/projects/create_spec.rb:14:in 'block (3 levels) in <top (required)>'
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

     9.2) Failure/Error: example.run

          NoMethodError:
            undefined method 'needs_server?' for nil
          # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
          # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  10) Creating Project when user is an admin when creating a non-billable creates a non-billable project successfully
      Got 0 failures and 2 other errors:

      10.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/create_spec.rb:14:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      10.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  11) Creating Project when user is an admin when creating a project without a name add project button is disabled
      Got 0 failures and 2 other errors:

      11.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/create_spec.rb:14:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      11.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  12) Creating Project when user is an employee new project button should not be visible for employees
      Got 0 failures and 2 other errors:

      12.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/create_spec.rb:75:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      12.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  13) Search projects when searching for a client displays the matching client in the list
      Got 0 failures and 2 other errors:

      13.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/search_spec.rb:15:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      13.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  14) Search projects when searching for a client displays a message when no match is found
      Got 0 failures and 2 other errors:

      14.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/projects/search_spec.rb:15:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      14.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  15) Time Tracking - day view when user is admin can view the time sheet entry
      Got 0 failures and 2 other errors:

      15.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:18:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      15.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  16) Time Tracking - day view when user is admin can add time entry
      Got 0 failures and 2 other errors:

      16.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:18:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      16.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  17) Time Tracking - day view when user is admin can edit time entry
      Got 0 failures and 2 other errors:

      17.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:18:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      17.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  18) Time Tracking - day view when user is admin can delete time entry
      Got 0 failures and 2 other errors:

      18.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:18:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      18.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  19) Time Tracking - day view when user is admin can view other users entry
      Got 0 failures and 2 other errors:

      19.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:18:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      19.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  20) Time Tracking - day view when user is employee can view the time sheet entry
      Got 0 failures and 2 other errors:

      20.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:98:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      20.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  21) Time Tracking - day view when user is employee can add time entry
      Got 0 failures and 2 other errors:

      21.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:98:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      21.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  22) Time Tracking - day view when user is employee can edit time entry
      Got 0 failures and 2 other errors:

      22.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:98:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      22.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  23) Time Tracking - day view when user is employee can delete time entry
      Got 0 failures and 2 other errors:

      23.1) Failure/Error: visit "/login"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/support/session_helpers.rb:6:in 'block in SessionHelpers#sign_in'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/support/session_helpers.rb:5:in 'SessionHelpers#sign_in'
            # ./spec/system/time_tracking/day_view_spec.rb:98:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      23.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  24) User Signup when signing up with a new email allows a user to sign up for the website
      Got 0 failures and 2 other errors:

      24.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:12:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:11:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      24.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  25) User Signup when signing up with a new email allows a user to sign up with a password containing hyphens as special characters
      Got 0 failures and 2 other errors:

      25.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:30:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:29:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      25.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  26) User Signup when signing up with a new email allows a user to sign up with a password containing blank spaces in between
      Got 0 failures and 2 other errors:

      26.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:48:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:47:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      26.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  27) User Signup when signing up with a new email allows to verify their email
      Got 0 failures and 2 other errors:

      27.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:66:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:65:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      27.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  28) User Signup when attempting to sign up with an existing email throws an error when using already registered email
      Got 0 failures and 2 other errors:

      28.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:93:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:92:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      28.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  29) User Signup when attempting to sign up with invalid password throws an error when using password with less than 8 characters
      Got 0 failures and 2 other errors:

      29.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:112:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:111:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      29.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  30) User Signup when attempting to sign up with invalid password throws an error when using password without at least one uppercase letter
      Got 0 failures and 2 other errors:

      30.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:129:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:128:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      30.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  31) User Signup when attempting to sign up with invalid password throws an error when using password without at least one lowercase letter
      Got 0 failures and 2 other errors:

      31.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:146:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:145:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      31.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  32) User Signup when attempting to sign up with invalid password throws an error when using password without at least one number
      Got 0 failures and 2 other errors:

      32.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:163:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:162:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      32.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  33) User Signup when attempting to sign up with invalid password throws an error when using password without at least one special character
      Got 0 failures and 2 other errors:

      33.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:180:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:179:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      33.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  34) User Signup when attempting to sign up with invalid password throws an error when using a password with spaces as special characters
      Got 0 failures and 2 other errors:

      34.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:197:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:196:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      34.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  35) User Signup when attempting to sign up with invalid password throws an error when using a password that starts with blank space
      Got 0 failures and 2 other errors:

      35.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:214:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:213:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      35.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  36) User Signup when attempting to sign up with invalid password throws an error when using a password that ends with blank space
      Got 0 failures and 2 other errors:

      36.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:231:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:230:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      36.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

  37) User Signup when attempting to sign up with invalid password throws an error when password and confirm password do not match
      Got 0 failures and 2 other errors:

      37.1) Failure/Error: visit "/signup"

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/system/users/signup_spec.rb:248:in 'block (4 levels) in <top (required)>'
            # ./spec/rails_helper.rb:101:in 'Object#with_forgery_protection'
            # ./spec/system/users/signup_spec.rb:247:in 'block (3 levels) in <top (required)>'
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

      37.2) Failure/Error: example.run

            NoMethodError:
              undefined method 'needs_server?' for nil
            # ./spec/rails_helper.rb:74:in 'block (2 levels) in <top (required)>'
            # ./spec/spec_helper.rb:42:in 'block (2 levels) in <top (required)>'

Finished in 1 minute 27.47 seconds (files took 14.04 seconds to load)
173 examples, 37 failures

Failed examples:

rspec ./spec/models/invoice_search_spec.rb:17 # Invoice search functionality Invoice.search basic search finds invoices by exact invoice number
rspec ./spec/models/invoice_search_spec.rb:23 # Invoice search functionality Invoice.search basic search finds invoices by partial invoice number
rspec ./spec/models/invoice_search_spec.rb:150 # Invoice search functionality Invoice.search pagination limits results
rspec ./spec/models/invoice_search_spec.rb:155 # Invoice search functionality Invoice.search pagination paginates correctly
rspec ./spec/models/invoice_search_spec.rb:166 # Invoice search functionality Invoice.search complex queries combines search term with status filter
rspec ./spec/models/metric_spec.rb:33 # Metric.fetch_or_calculate when metric exists and is fresh returns existing metric without recalculation
rspec ./spec/models/metric_spec.rb:101 # Metric#calculate! calculates client revenue metrics
rspec ./spec/models/metric_spec.rb:119 # Metric#stale? when calculated recently returns false
rspec ./spec/system/projects/create_spec.rb:18 # Creating Project when user is an admin when creating a billable project creates a billable project successfully
rspec ./spec/system/projects/create_spec.rb:37 # Creating Project when user is an admin when creating a non-billable creates a non-billable project successfully
rspec ./spec/system/projects/create_spec.rb:55 # Creating Project when user is an admin when creating a project without a name add project button is disabled
rspec ./spec/system/projects/create_spec.rb:78 # Creating Project when user is an employee new project button should not be visible for employees
rspec ./spec/system/projects/search_spec.rb:18 # Search projects when searching for a client displays the matching client in the list
rspec ./spec/system/projects/search_spec.rb:29 # Search projects when searching for a client displays a message when no match is found
rspec ./spec/system/time_tracking/day_view_spec.rb:21 # Time Tracking - day view when user is admin can view the time sheet entry
rspec ./spec/system/time_tracking/day_view_spec.rb:32 # Time Tracking - day view when user is admin can add time entry
rspec ./spec/system/time_tracking/day_view_spec.rb:48 # Time Tracking - day view when user is admin can edit time entry
rspec ./spec/system/time_tracking/day_view_spec.rb:62 # Time Tracking - day view when user is admin can delete time entry
rspec ./spec/system/time_tracking/day_view_spec.rb:75 # Time Tracking - day view when user is admin can view other users entry
rspec ./spec/system/time_tracking/day_view_spec.rb:101 # Time Tracking - day view when user is employee can view the time sheet entry
rspec ./spec/system/time_tracking/day_view_spec.rb:112 # Time Tracking - day view when user is employee can add time entry
rspec ./spec/system/time_tracking/day_view_spec.rb:127 # Time Tracking - day view when user is employee can edit time entry
rspec ./spec/system/time_tracking/day_view_spec.rb:142 # Time Tracking - day view when user is employee can delete time entry
rspec ./spec/system/users/signup_spec.rb:10 # User Signup when signing up with a new email allows a user to sign up for the website
rspec ./spec/system/users/signup_spec.rb:28 # User Signup when signing up with a new email allows a user to sign up with a password containing hyphens as special characters
rspec ./spec/system/users/signup_spec.rb:46 # User Signup when signing up with a new email allows a user to sign up with a password containing blank spaces in between
rspec ./spec/system/users/signup_spec.rb:64 # User Signup when signing up with a new email allows to verify their email
rspec ./spec/system/users/signup_spec.rb:91 # User Signup when attempting to sign up with an existing email throws an error when using already registered email
rspec ./spec/system/users/signup_spec.rb:110 # User Signup when attempting to sign up with invalid password throws an error when using password with less than 8 characters
rspec ./spec/system/users/signup_spec.rb:127 # User Signup when attempting to sign up with invalid password throws an error when using password without at least one uppercase letter
rspec ./spec/system/users/signup_spec.rb:144 # User Signup when attempting to sign up with invalid password throws an error when using password without at least one lowercase letter
rspec ./spec/system/users/signup_spec.rb:161 # User Signup when attempting to sign up with invalid password throws an error when using password without at least one number
rspec ./spec/system/users/signup_spec.rb:178 # User Signup when attempting to sign up with invalid password throws an error when using password without at least one special character
rspec ./spec/system/users/signup_spec.rb:195 # User Signup when attempting to sign up with invalid password throws an error when using a password with spaces as special characters
rspec ./spec/system/users/signup_spec.rb:212 # User Signup when attempting to sign up with invalid password throws an error when using a password that starts with blank space
rspec ./spec/system/users/signup_spec.rb:229 # User Signup when attempting to sign up with invalid password throws an error when using a password that ends with blank space
rspec ./spec/system/users/signup_spec.rb:246 # User Signup when attempting to sign up with invalid password throws an error when password and confirm password do not match

